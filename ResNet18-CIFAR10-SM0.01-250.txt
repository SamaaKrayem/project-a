import torch
import torch.nn as nn
import torch.nn.functional as F
import numpy as np
import warnings
from typing import Optional, Tuple

import torch
from torch import Tensor
from torch.nn.init import constant_, xavier_normal_, xavier_uniform_
from torch.nn.parameter import Parameter
import torch.autograd
from torch import autograd

sm_alpha=0.01

def SMrelu_forward(z: Tensor, alpha: float):
    relu_positive = z
    relu_zero = 0
    relu_output = torch.where(z>0, relu_positive, relu_zero)
    return relu_output
  

class SMRELUFunction(torch.autograd.Function):
    
    @staticmethod
    def forward(ctx, z: Tensor, alpha: float):
        relu = SMrelu_forward(z, alpha) # Regular forward pass computation from before
        ctx.save_for_backward(z)    # Tensors should be saved using this method
        ctx.alpha = alpha           # other properties can be saved like so
        return relu
    
    @staticmethod
    def backward(ctx, grad_output):
        z, = ctx.saved_tensors      # Validates that no in-place modifications happened on saved tensors
        alpha = ctx.alpha
        
        # Calculate diagonal of d(elu(z))/dz
        grad_positive = torch.ones_like(z)
        grad_zero = 0
        
        # Note: This is not the full Jacobian, d(elu(z))/dz, it's the diagonal
        grad_SMrelu = torch.where(z > ((-1)*alpha), grad_positive, grad_zero)
        
        # Gradient of the loss w.r.t. our output
        δ_smrelu = grad_output
        
        # Calcualte δz = d(elu(z))/dz * δ_elu
        # Note: elementwise multiplication equivalant to vector-Jacobian product
        δz = grad_SMrelu * δ_smrelu
        return δz, None

class BasicBlock(nn.Module):
    expansion = 1

    def __init__(self, in_planes, planes, stride=1):
        super(BasicBlock, self).__init__()
        self.conv1 = nn.Conv2d(
            in_planes, planes, kernel_size=3, stride=stride, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(planes)
        self.conv2 = nn.Conv2d(planes, planes, kernel_size=3,
                               stride=1, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(planes)

        self.shortcut = nn.Sequential()
        if stride != 1 or in_planes != self.expansion*planes:
            self.shortcut = nn.Sequential(
                nn.Conv2d(in_planes, self.expansion*planes,
                          kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm2d(self.expansion*planes)
            )

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = self.bn2(self.conv2(out))
        out += self.shortcut(x)
        out = SMRELUFunction.apply(out,sm_alpha)
        return out

class Bottleneck(nn.Module):
    expansion = 4

    def __init__(self, in_planes, planes, stride=1):
        super(Bottleneck, self).__init__()
        self.conv1 = nn.Conv2d(in_planes, planes, kernel_size=1, bias=False)
        self.bn1 = nn.BatchNorm2d(planes)
        self.conv2 = nn.Conv2d(planes, planes, kernel_size=3,
                               stride=stride, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(planes)
        self.conv3 = nn.Conv2d(planes, self.expansion *
                               planes, kernel_size=1, bias=False)
        self.bn3 = nn.BatchNorm2d(self.expansion*planes)

        self.shortcut = nn.Sequential()
        if stride != 1 or in_planes != self.expansion*planes:
            self.shortcut = nn.Sequential(
                nn.Conv2d(in_planes, self.expansion*planes,
                          kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm2d(self.expansion*planes)
            )

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = SMRELUFunction.apply(self.bn2(self.conv2(out)),sm_alpha)
        out = self.bn3(self.conv3(out))
        out += self.shortcut(x)
        out = SMRELUFunction.apply(out,sm_alpha)
        return out

class ResNet(nn.Module):
    def __init__(self, block, num_blocks, num_classes=10):
        super(ResNet, self).__init__()
        self.in_planes = 64

        self.conv1 = nn.Conv2d(3, 64, kernel_size=3,
                               stride=1, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(64)
        self.layer1 = self._make_layer(block, 64, num_blocks[0], stride=1)
        self.layer2 = self._make_layer(block, 128, num_blocks[1], stride=2)
        self.layer3 = self._make_layer(block, 256, num_blocks[2], stride=2)
        self.layer4 = self._make_layer(block, 512, num_blocks[3], stride=2)
        self.linear = nn.Linear(512*block.expansion, num_classes)

    def _make_layer(self, block, planes, num_blocks, stride):
        strides = [stride] + [1]*(num_blocks-1)
        layers = []
        for stride in strides:
            layers.append(block(self.in_planes, planes, stride))
            self.in_planes = planes * block.expansion
        return nn.Sequential(*layers)

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = self.layer1(out)
        out = self.layer2(out)
        out = self.layer3(out)
        out = self.layer4(out)
        out = F.avg_pool2d(out, 4)
        out = out.view(out.size(0), -1)
        out = self.linear(out)
        return out

def ResNet18():
    return ResNet(BasicBlock, [2, 2, 2, 2])


def ResNet34():
    return ResNet(BasicBlock, [3, 4, 6, 3])


def ResNet50():
    return ResNet(Bottleneck, [3, 4, 6, 3])


def ResNet101():
    return ResNet(Bottleneck, [3, 4, 23, 3])


def ResNet152():
    return ResNet(Bottleneck, [3, 8, 36, 3])


def test():
    net = ResNet18()
    y = net(torch.randn(1, 3, 32, 32))
    print(y.size())

import time
import os
import sys
import shutil

TOTAL_BAR_LENGTH=65
_, term_width = shutil.get_terminal_size()
term_width = int(term_width)
last_time = time.time()
begin_time = last_time

def format_time(seconds):
    days = int(seconds / 3600/24)
    seconds = seconds - days*3600*24
    hours = int(seconds / 3600)
    seconds = seconds - hours*3600
    minutes = int(seconds / 60)
    seconds = seconds - minutes*60
    secondsf = int(seconds)
    seconds = seconds - secondsf
    millis = int(seconds*1000)

    f = ''
    i = 1
    if days > 0:
        f += str(days) + 'D'
        i += 1
    if hours > 0 and i <= 2:
        f += str(hours) + 'h'
        i += 1
    if minutes > 0 and i <= 2:
        f += str(minutes) + 'm'
        i += 1
    if secondsf > 0 and i <= 2:
        f += str(secondsf) + 's'
        i += 1
    if millis > 0 and i <= 2:
        f += str(millis) + 'ms'
        i += 1
    if f == '':
        f = '0ms'
    return f

def progress_bar(current, total, msg=None):
    global last_time, begin_time
    if current == 0:
        begin_time = time.time()  # Reset for new bar.

    cur_len = int(TOTAL_BAR_LENGTH*current/total)
    rest_len = int(TOTAL_BAR_LENGTH - cur_len) - 1

    sys.stdout.write(' [')
    for i in range(cur_len):
        sys.stdout.write('=')
    sys.stdout.write('>')
    for i in range(rest_len):
        sys.stdout.write('.')
    sys.stdout.write(']')

    cur_time = time.time()
    step_time = cur_time - last_time
    last_time = cur_time
    tot_time = cur_time - begin_time

    L = []
    L.append('  Step: %s' % format_time(step_time))
    L.append(' | Tot: %s' % format_time(tot_time))
    if msg:
        L.append(' | ' + msg)

    msg = ''.join(L)
    sys.stdout.write(msg)
    for i in range(term_width-int(TOTAL_BAR_LENGTH)-len(msg)-3):
        sys.stdout.write(' ')

    # Go back to the center of the bar.
    for i in range(term_width-int(TOTAL_BAR_LENGTH/2)+2):
        sys.stdout.write('\b')
    sys.stdout.write(' %d/%d ' % (current+1, total))

    if current < total-1:
        sys.stdout.write('\r')
    else:
        sys.stdout.write('\n')
    sys.stdout.flush()

import torch.optim as optim
import torch.backends.cudnn as cudnn

import torchvision
import torchvision.transforms as transforms

import argparse

parser = argparse.ArgumentParser(description='PyTorch CIFAR10 Training')
parser.add_argument('-f')
parser.add_argument('--lr', default=0.1, type=float, help='learning rate')
parser.add_argument('--resume', '-r', action='store_true',
                    help='resume from checkpoint')
args = parser.parse_args()

device = 'cuda' if torch.cuda.is_available() else 'cpu'
best_acc = 0  # best test accuracy
start_epoch = 0  # start from epoch 0 or last checkpoint epoch

# Data
print('==> Preparing data..')
transform_train = transforms.Compose([
    transforms.RandomCrop(32, padding=4),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(),
    transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
])

transform_test = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
])

trainset = torchvision.datasets.CIFAR10(
    root='./data', train=True, download=True, transform=transform_train)
trainloader = torch.utils.data.DataLoader(
    trainset, batch_size=128, shuffle=True, num_workers=2)

testset = torchvision.datasets.CIFAR10(
    root='./data', train=False, download=True, transform=transform_test)
testloader = torch.utils.data.DataLoader(
    testset, batch_size=100, shuffle=False, num_workers=2)

classes = ('plane', 'car', 'bird', 'cat', 'deer',
           'dog', 'frog', 'horse', 'ship', 'truck')

print('==> Building model..')
net = ResNet18()

net = net.to(device)
if device == 'cuda':
    net = torch.nn.DataParallel(net)
    cudnn.benchmark = True

if args.resume:
    # Load checkpoint.
    print('==> Resuming from checkpoint..')
    assert os.path.isdir('checkpoint'), 'Error: no checkpoint directory found!'
    checkpoint = torch.load('./checkpoint/ckpt.pth')
    net.load_state_dict(checkpoint['net'])
    best_acc = checkpoint['acc']
    start_epoch = checkpoint['epoch']

criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(net.parameters(), lr=args.lr,
                      momentum=0.9, weight_decay=5e-4)
scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=200)

# Training
def train(epoch):
    print('\nEpoch: %d' % epoch)
    net.train()
    train_loss = 0
    correct = 0
    total = 0
    for batch_idx, (inputs, targets) in enumerate(trainloader):
        inputs, targets = inputs.to(device), targets.to(device)
        optimizer.zero_grad()
        outputs = net(inputs)
        loss = criterion(outputs, targets)
        loss.backward()
        optimizer.step()

        train_loss += loss.item()
        _, predicted = outputs.max(1)
        total += targets.size(0)
        correct += predicted.eq(targets).sum().item()

        progress_bar(batch_idx, len(trainloader), 'Loss: %.3f | Acc: %.3f%% (%d/%d)'
                     % (train_loss/(batch_idx+1), 100.*correct/total, correct, total))


def test(epoch):
    global best_acc
    net.eval()
    test_loss = 0
    correct = 0
    total = 0
    with torch.no_grad():
        for batch_idx, (inputs, targets) in enumerate(testloader):
            inputs, targets = inputs.to(device), targets.to(device)
            outputs = net(inputs)
            loss = criterion(outputs, targets)

            test_loss += loss.item()
            _, predicted = outputs.max(1)
            total += targets.size(0)
            correct += predicted.eq(targets).sum().item()

            progress_bar(batch_idx, len(testloader), 'Loss: %.3f | Acc: %.3f%% (%d/%d)'
                         % (test_loss/(batch_idx+1), 100.*correct/total, correct, total))

    # Save checkpoint.
    acc = 100.*correct/total
    if acc > best_acc:
        print('Saving..')
        state = {
            'net': net.state_dict(),
            'acc': acc,
            'epoch': epoch,
        }
        if not os.path.isdir('checkpoint'):
            os.mkdir('checkpoint')
        torch.save(state, './checkpoint/ckpt.pth')
        best_acc = acc


for epoch in range(start_epoch, start_epoch+250):
    train(epoch)
    test(epoch)
    scheduler.step()



Epoch: 0
 [================================================================>]  Step: 603ms | Tot: 46s135ms | Loss: 1.869 | Acc: 31.854% (15927/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s274ms | Loss: 1.498 | Acc: 43.570% (4357/10000) 100/100 
Saving..

Epoch: 1
 [================================================================>]  Step: 80ms | Tot: 46s298ms | Loss: 1.409 | Acc: 48.432% (24216/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s244ms | Loss: 1.234 | Acc: 55.330% (5533/10000) 100/100 
Saving..

Epoch: 2
 [================================================================>]  Step: 77ms | Tot: 46s39ms | Loss: 1.118 | Acc: 60.244% (30122/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s179ms | Loss: 0.993 | Acc: 64.470% (6447/10000) 100/100 
Saving..

Epoch: 3
 [================================================================>]  Step: 83ms | Tot: 46s323ms | Loss: 0.929 | Acc: 67.094% (33547/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s178ms | Loss: 0.898 | Acc: 68.780% (6878/10000) 100/100 
Saving..

Epoch: 4
 [================================================================>]  Step: 73ms | Tot: 46s450ms | Loss: 0.788 | Acc: 72.486% (36243/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s263ms | Loss: 0.814 | Acc: 72.710% (7271/10000) 100/100 
Saving..

Epoch: 5
 [================================================================>]  Step: 81ms | Tot: 46s397ms | Loss: 0.677 | Acc: 76.578% (38289/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s337ms | Loss: 0.798 | Acc: 72.670% (7267/10000) 100/100 

Epoch: 6
 [================================================================>]  Step: 82ms | Tot: 46s291ms | Loss: 0.608 | Acc: 79.002% (39501/50000) 391/391 
 [================================================================>]  Step: 54ms | Tot: 4s485ms | Loss: 0.699 | Acc: 76.350% (7635/10000) 100/100 
Saving..

Epoch: 7
 [================================================================>]  Step: 82ms | Tot: 46s426ms | Loss: 0.560 | Acc: 80.728% (40364/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s235ms | Loss: 0.763 | Acc: 74.630% (7463/10000) 100/100 

Epoch: 8
 [================================================================>]  Step: 77ms | Tot: 46s310ms | Loss: 0.536 | Acc: 81.516% (40758/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s181ms | Loss: 0.811 | Acc: 75.120% (7512/10000) 100/100 

Epoch: 9
 [================================================================>]  Step: 80ms | Tot: 46s266ms | Loss: 0.516 | Acc: 82.206% (41103/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s263ms | Loss: 0.694 | Acc: 77.090% (7709/10000) 100/100 
Saving..

Epoch: 10
 [================================================================>]  Step: 88ms | Tot: 46s199ms | Loss: 0.492 | Acc: 83.080% (41540/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s308ms | Loss: 0.543 | Acc: 81.820% (8182/10000) 100/100 
Saving..

Epoch: 11
 [================================================================>]  Step: 80ms | Tot: 46s573ms | Loss: 0.473 | Acc: 83.702% (41851/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s205ms | Loss: 0.778 | Acc: 75.410% (7541/10000) 100/100 

Epoch: 12
 [================================================================>]  Step: 84ms | Tot: 46s378ms | Loss: 0.459 | Acc: 84.400% (42200/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s286ms | Loss: 0.802 | Acc: 75.300% (7530/10000) 100/100 

Epoch: 13
 [================================================================>]  Step: 83ms | Tot: 46s105ms | Loss: 0.446 | Acc: 84.658% (42329/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s637ms | Loss: 0.538 | Acc: 82.120% (8212/10000) 100/100 
Saving..

Epoch: 14
 [================================================================>]  Step: 85ms | Tot: 46s67ms | Loss: 0.431 | Acc: 85.176% (42588/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s307ms | Loss: 0.693 | Acc: 78.730% (7873/10000) 100/100 

Epoch: 15
 [================================================================>]  Step: 70ms | Tot: 46s417ms | Loss: 0.422 | Acc: 85.656% (42828/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s172ms | Loss: 0.518 | Acc: 82.590% (8259/10000) 100/100 
Saving..

Epoch: 16
 [================================================================>]  Step: 89ms | Tot: 46s251ms | Loss: 0.408 | Acc: 85.992% (42996/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s305ms | Loss: 0.675 | Acc: 78.160% (7816/10000) 100/100 

Epoch: 17
 [================================================================>]  Step: 81ms | Tot: 46s225ms | Loss: 0.407 | Acc: 85.888% (42944/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s181ms | Loss: 0.581 | Acc: 81.120% (8112/10000) 100/100 

Epoch: 18
 [================================================================>]  Step: 81ms | Tot: 46s202ms | Loss: 0.394 | Acc: 86.480% (43240/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s197ms | Loss: 0.488 | Acc: 83.340% (8334/10000) 100/100 
Saving..

Epoch: 19
 [================================================================>]  Step: 81ms | Tot: 46s211ms | Loss: 0.385 | Acc: 86.774% (43387/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s388ms | Loss: 0.490 | Acc: 83.290% (8329/10000) 100/100 

Epoch: 20
 [================================================================>]  Step: 82ms | Tot: 46s620ms | Loss: 0.383 | Acc: 86.848% (43424/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s315ms | Loss: 0.497 | Acc: 83.620% (8362/10000) 100/100 
Saving..

Epoch: 21
 [================================================================>]  Step: 84ms | Tot: 46s564ms | Loss: 0.380 | Acc: 87.192% (43596/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s215ms | Loss: 0.513 | Acc: 82.080% (8208/10000) 100/100 

Epoch: 22
 [================================================================>]  Step: 80ms | Tot: 46s346ms | Loss: 0.376 | Acc: 87.196% (43598/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s451ms | Loss: 0.470 | Acc: 84.390% (8439/10000) 100/100 
Saving..

Epoch: 23
 [================================================================>]  Step: 79ms | Tot: 46s335ms | Loss: 0.369 | Acc: 87.500% (43750/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s149ms | Loss: 0.556 | Acc: 81.350% (8135/10000) 100/100 

Epoch: 24
 [================================================================>]  Step: 83ms | Tot: 45s983ms | Loss: 0.368 | Acc: 87.600% (43800/50000) 391/391 
 [================================================================>]  Step: 56ms | Tot: 4s213ms | Loss: 0.546 | Acc: 82.050% (8205/10000) 100/100 

Epoch: 25
 [================================================================>]  Step: 80ms | Tot: 46s121ms | Loss: 0.360 | Acc: 87.536% (43768/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s161ms | Loss: 0.561 | Acc: 81.770% (8177/10000) 100/100 

Epoch: 26
 [================================================================>]  Step: 86ms | Tot: 46s215ms | Loss: 0.356 | Acc: 87.858% (43929/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s270ms | Loss: 0.631 | Acc: 80.970% (8097/10000) 100/100 

Epoch: 27
 [================================================================>]  Step: 74ms | Tot: 45s957ms | Loss: 0.354 | Acc: 87.882% (43941/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s185ms | Loss: 0.575 | Acc: 81.200% (8120/10000) 100/100 

Epoch: 28
 [================================================================>]  Step: 72ms | Tot: 46s308ms | Loss: 0.351 | Acc: 87.888% (43944/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s242ms | Loss: 0.554 | Acc: 82.340% (8234/10000) 100/100 

Epoch: 29
 [================================================================>]  Step: 77ms | Tot: 45s985ms | Loss: 0.348 | Acc: 88.286% (44143/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s499ms | Loss: 0.561 | Acc: 82.010% (8201/10000) 100/100 

Epoch: 30
 [================================================================>]  Step: 88ms | Tot: 46s330ms | Loss: 0.342 | Acc: 88.296% (44148/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s89ms | Loss: 0.795 | Acc: 76.290% (7629/10000) 100/100 

Epoch: 31
 [================================================================>]  Step: 82ms | Tot: 46s636ms | Loss: 0.343 | Acc: 88.162% (44081/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s309ms | Loss: 0.416 | Acc: 86.090% (8609/10000) 100/100 
Saving..

Epoch: 32
 [================================================================>]  Step: 82ms | Tot: 46s392ms | Loss: 0.341 | Acc: 88.416% (44208/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s298ms | Loss: 0.510 | Acc: 83.250% (8325/10000) 100/100 

Epoch: 33
 [================================================================>]  Step: 81ms | Tot: 46s157ms | Loss: 0.336 | Acc: 88.448% (44224/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s148ms | Loss: 0.469 | Acc: 84.670% (8467/10000) 100/100 

Epoch: 34
 [================================================================>]  Step: 83ms | Tot: 45s934ms | Loss: 0.332 | Acc: 88.778% (44389/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s231ms | Loss: 0.479 | Acc: 83.840% (8384/10000) 100/100 

Epoch: 35
 [================================================================>]  Step: 83ms | Tot: 46s283ms | Loss: 0.333 | Acc: 88.498% (44249/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s195ms | Loss: 0.582 | Acc: 80.910% (8091/10000) 100/100 

Epoch: 36
 [================================================================>]  Step: 80ms | Tot: 46s250ms | Loss: 0.329 | Acc: 88.812% (44406/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s173ms | Loss: 0.441 | Acc: 85.060% (8506/10000) 100/100 

Epoch: 37
 [================================================================>]  Step: 81ms | Tot: 46s58ms | Loss: 0.324 | Acc: 88.902% (44451/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s180ms | Loss: 0.515 | Acc: 83.520% (8352/10000) 100/100 

Epoch: 38
 [================================================================>]  Step: 85ms | Tot: 46s436ms | Loss: 0.327 | Acc: 88.888% (44444/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s189ms | Loss: 0.558 | Acc: 82.620% (8262/10000) 100/100 

Epoch: 39
 [================================================================>]  Step: 76ms | Tot: 45s972ms | Loss: 0.326 | Acc: 88.886% (44443/50000) 391/391 
 [================================================================>]  Step: 51ms | Tot: 4s330ms | Loss: 0.501 | Acc: 83.830% (8383/10000) 100/100 

Epoch: 40
 [================================================================>]  Step: 84ms | Tot: 46s400ms | Loss: 0.320 | Acc: 89.016% (44508/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s190ms | Loss: 0.397 | Acc: 86.860% (8686/10000) 100/100 
Saving..

Epoch: 41
 [================================================================>]  Step: 73ms | Tot: 46s232ms | Loss: 0.316 | Acc: 89.272% (44636/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s326ms | Loss: 0.507 | Acc: 83.650% (8365/10000) 100/100 

Epoch: 42
 [================================================================>]  Step: 92ms | Tot: 46s226ms | Loss: 0.318 | Acc: 89.174% (44587/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s94ms | Loss: 0.499 | Acc: 83.630% (8363/10000) 100/100 

Epoch: 43
 [================================================================>]  Step: 83ms | Tot: 46s224ms | Loss: 0.317 | Acc: 89.112% (44556/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s384ms | Loss: 0.537 | Acc: 82.760% (8276/10000) 100/100 

Epoch: 44
 [================================================================>]  Step: 84ms | Tot: 46s70ms | Loss: 0.309 | Acc: 89.514% (44757/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s155ms | Loss: 0.487 | Acc: 84.430% (8443/10000) 100/100 

Epoch: 45
 [================================================================>]  Step: 84ms | Tot: 46s304ms | Loss: 0.310 | Acc: 89.370% (44685/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s246ms | Loss: 0.555 | Acc: 82.320% (8232/10000) 100/100 

Epoch: 46
 [================================================================>]  Step: 79ms | Tot: 46s241ms | Loss: 0.306 | Acc: 89.536% (44768/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s154ms | Loss: 0.493 | Acc: 83.720% (8372/10000) 100/100 

Epoch: 47
 [================================================================>]  Step: 85ms | Tot: 46s333ms | Loss: 0.307 | Acc: 89.702% (44851/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s222ms | Loss: 0.446 | Acc: 85.520% (8552/10000) 100/100 

Epoch: 48
 [================================================================>]  Step: 79ms | Tot: 46s102ms | Loss: 0.312 | Acc: 89.336% (44668/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 5s85ms | Loss: 0.505 | Acc: 83.890% (8389/10000) 100/100 

Epoch: 49
 [================================================================>]  Step: 81ms | Tot: 46s134ms | Loss: 0.299 | Acc: 89.948% (44974/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s177ms | Loss: 0.425 | Acc: 85.770% (8577/10000) 100/100 

Epoch: 50
 [================================================================>]  Step: 79ms | Tot: 46s433ms | Loss: 0.299 | Acc: 89.808% (44904/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s322ms | Loss: 0.573 | Acc: 81.300% (8130/10000) 100/100 

Epoch: 51
 [================================================================>]  Step: 84ms | Tot: 46s405ms | Loss: 0.300 | Acc: 89.852% (44926/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s267ms | Loss: 0.463 | Acc: 84.860% (8486/10000) 100/100 

Epoch: 52
 [================================================================>]  Step: 89ms | Tot: 46s53ms | Loss: 0.295 | Acc: 90.002% (45001/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s229ms | Loss: 0.482 | Acc: 84.140% (8414/10000) 100/100 

Epoch: 53
 [================================================================>]  Step: 84ms | Tot: 46s50ms | Loss: 0.294 | Acc: 89.996% (44998/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s382ms | Loss: 0.461 | Acc: 85.160% (8516/10000) 100/100 

Epoch: 54
 [================================================================>]  Step: 81ms | Tot: 46s399ms | Loss: 0.292 | Acc: 90.072% (45036/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s296ms | Loss: 0.481 | Acc: 83.830% (8383/10000) 100/100 

Epoch: 55
 [================================================================>]  Step: 80ms | Tot: 46s431ms | Loss: 0.288 | Acc: 90.298% (45149/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s322ms | Loss: 0.432 | Acc: 85.540% (8554/10000) 100/100 

Epoch: 56
 [================================================================>]  Step: 84ms | Tot: 46s507ms | Loss: 0.285 | Acc: 90.322% (45161/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s270ms | Loss: 0.400 | Acc: 87.100% (8710/10000) 100/100 
Saving..

Epoch: 57
 [================================================================>]  Step: 79ms | Tot: 46s355ms | Loss: 0.285 | Acc: 90.236% (45118/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s253ms | Loss: 0.640 | Acc: 80.060% (8006/10000) 100/100 

Epoch: 58
 [================================================================>]  Step: 76ms | Tot: 45s930ms | Loss: 0.282 | Acc: 90.320% (45160/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s417ms | Loss: 0.584 | Acc: 81.610% (8161/10000) 100/100 

Epoch: 59
 [================================================================>]  Step: 82ms | Tot: 46s410ms | Loss: 0.280 | Acc: 90.458% (45229/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s353ms | Loss: 0.551 | Acc: 82.750% (8275/10000) 100/100 

Epoch: 60
 [================================================================>]  Step: 84ms | Tot: 46s634ms | Loss: 0.274 | Acc: 90.602% (45301/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s407ms | Loss: 0.418 | Acc: 86.500% (8650/10000) 100/100 

Epoch: 61
 [================================================================>]  Step: 81ms | Tot: 46s405ms | Loss: 0.273 | Acc: 90.670% (45335/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s182ms | Loss: 0.467 | Acc: 84.960% (8496/10000) 100/100 

Epoch: 62
 [================================================================>]  Step: 81ms | Tot: 46s261ms | Loss: 0.276 | Acc: 90.712% (45356/50000) 391/391 
 [================================================================>]  Step: 27ms | Tot: 4s813ms | Loss: 0.421 | Acc: 86.290% (8629/10000) 100/100 

Epoch: 63
 [================================================================>]  Step: 80ms | Tot: 46s43ms | Loss: 0.270 | Acc: 90.792% (45396/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s159ms | Loss: 0.483 | Acc: 84.960% (8496/10000) 100/100 

Epoch: 64
 [================================================================>]  Step: 78ms | Tot: 46s158ms | Loss: 0.272 | Acc: 90.846% (45423/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s289ms | Loss: 0.349 | Acc: 88.050% (8805/10000) 100/100 
Saving..

Epoch: 65
 [================================================================>]  Step: 83ms | Tot: 46s463ms | Loss: 0.272 | Acc: 90.636% (45318/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s173ms | Loss: 0.409 | Acc: 86.030% (8603/10000) 100/100 

Epoch: 66
 [================================================================>]  Step: 84ms | Tot: 45s935ms | Loss: 0.269 | Acc: 90.710% (45355/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 5s38ms | Loss: 0.515 | Acc: 83.180% (8318/10000) 100/100 

Epoch: 67
 [================================================================>]  Step: 81ms | Tot: 46s220ms | Loss: 0.264 | Acc: 90.910% (45455/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s341ms | Loss: 0.410 | Acc: 86.440% (8644/10000) 100/100 

Epoch: 68
 [================================================================>]  Step: 78ms | Tot: 46s395ms | Loss: 0.259 | Acc: 91.128% (45564/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s251ms | Loss: 0.405 | Acc: 86.570% (8657/10000) 100/100 

Epoch: 69
 [================================================================>]  Step: 80ms | Tot: 46s322ms | Loss: 0.268 | Acc: 90.866% (45433/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s244ms | Loss: 0.499 | Acc: 84.180% (8418/10000) 100/100 

Epoch: 70
 [================================================================>]  Step: 68ms | Tot: 46s300ms | Loss: 0.260 | Acc: 91.144% (45572/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s259ms | Loss: 0.420 | Acc: 86.650% (8665/10000) 100/100 

Epoch: 71
 [================================================================>]  Step: 78ms | Tot: 46s93ms | Loss: 0.254 | Acc: 91.368% (45684/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s350ms | Loss: 0.342 | Acc: 88.820% (8882/10000) 100/100 
Saving..

Epoch: 72
 [================================================================>]  Step: 84ms | Tot: 46s170ms | Loss: 0.255 | Acc: 91.410% (45705/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s282ms | Loss: 0.491 | Acc: 84.820% (8482/10000) 100/100 

Epoch: 73
 [================================================================>]  Step: 81ms | Tot: 46s337ms | Loss: 0.254 | Acc: 91.228% (45614/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s151ms | Loss: 0.397 | Acc: 87.110% (8711/10000) 100/100 

Epoch: 74
 [================================================================>]  Step: 75ms | Tot: 46s627ms | Loss: 0.247 | Acc: 91.552% (45776/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s210ms | Loss: 0.381 | Acc: 87.570% (8757/10000) 100/100 

Epoch: 75
 [================================================================>]  Step: 78ms | Tot: 45s851ms | Loss: 0.250 | Acc: 91.424% (45712/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s410ms | Loss: 0.452 | Acc: 85.710% (8571/10000) 100/100 

Epoch: 76
 [================================================================>]  Step: 78ms | Tot: 46s208ms | Loss: 0.249 | Acc: 91.612% (45806/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s296ms | Loss: 0.524 | Acc: 83.910% (8391/10000) 100/100 

Epoch: 77
 [================================================================>]  Step: 78ms | Tot: 46s339ms | Loss: 0.248 | Acc: 91.558% (45779/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s328ms | Loss: 0.385 | Acc: 87.320% (8732/10000) 100/100 

Epoch: 78
 [================================================================>]  Step: 86ms | Tot: 46s718ms | Loss: 0.242 | Acc: 91.684% (45842/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s296ms | Loss: 0.385 | Acc: 87.600% (8760/10000) 100/100 

Epoch: 79
 [================================================================>]  Step: 83ms | Tot: 46s12ms | Loss: 0.237 | Acc: 92.034% (46017/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 5s16ms | Loss: 0.374 | Acc: 87.430% (8743/10000) 100/100 

Epoch: 80
 [================================================================>]  Step: 81ms | Tot: 45s962ms | Loss: 0.240 | Acc: 91.778% (45889/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s52ms | Loss: 0.470 | Acc: 84.100% (8410/10000) 100/100 

Epoch: 81
 [================================================================>]  Step: 73ms | Tot: 45s700ms | Loss: 0.232 | Acc: 92.042% (46021/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s112ms | Loss: 0.366 | Acc: 87.710% (8771/10000) 100/100 

Epoch: 82
 [================================================================>]  Step: 82ms | Tot: 45s554ms | Loss: 0.237 | Acc: 91.900% (45950/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s65ms | Loss: 0.408 | Acc: 87.140% (8714/10000) 100/100 

Epoch: 83
 [================================================================>]  Step: 82ms | Tot: 45s564ms | Loss: 0.229 | Acc: 92.230% (46115/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s143ms | Loss: 0.428 | Acc: 86.470% (8647/10000) 100/100 

Epoch: 84
 [================================================================>]  Step: 92ms | Tot: 45s374ms | Loss: 0.230 | Acc: 92.174% (46087/50000) 391/391 
 [================================================================>]  Step: 77ms | Tot: 4s14ms | Loss: 0.482 | Acc: 85.180% (8518/10000) 100/100 

Epoch: 85
 [================================================================>]  Step: 80ms | Tot: 45s300ms | Loss: 0.224 | Acc: 92.418% (46209/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s130ms | Loss: 0.362 | Acc: 88.250% (8825/10000) 100/100 

Epoch: 86
 [================================================================>]  Step: 69ms | Tot: 45s596ms | Loss: 0.224 | Acc: 92.338% (46169/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s266ms | Loss: 0.399 | Acc: 87.670% (8767/10000) 100/100 

Epoch: 87
 [================================================================>]  Step: 82ms | Tot: 45s409ms | Loss: 0.220 | Acc: 92.378% (46189/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s567ms | Loss: 0.388 | Acc: 87.670% (8767/10000) 100/100 

Epoch: 88
 [================================================================>]  Step: 76ms | Tot: 45s345ms | Loss: 0.221 | Acc: 92.502% (46251/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s45ms | Loss: 0.375 | Acc: 87.880% (8788/10000) 100/100 

Epoch: 89
 [================================================================>]  Step: 76ms | Tot: 46s17ms | Loss: 0.216 | Acc: 92.654% (46327/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s55ms | Loss: 0.455 | Acc: 84.990% (8499/10000) 100/100 

Epoch: 90
 [================================================================>]  Step: 81ms | Tot: 45s489ms | Loss: 0.212 | Acc: 92.798% (46399/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s91ms | Loss: 0.378 | Acc: 87.840% (8784/10000) 100/100 

Epoch: 91
 [================================================================>]  Step: 78ms | Tot: 45s586ms | Loss: 0.214 | Acc: 92.718% (46359/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s190ms | Loss: 0.379 | Acc: 87.860% (8786/10000) 100/100 

Epoch: 92
 [================================================================>]  Step: 67ms | Tot: 45s324ms | Loss: 0.207 | Acc: 92.892% (46446/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s76ms | Loss: 0.333 | Acc: 89.180% (8918/10000) 100/100 
Saving..

Epoch: 93
 [================================================================>]  Step: 91ms | Tot: 45s816ms | Loss: 0.205 | Acc: 93.070% (46535/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s35ms | Loss: 0.451 | Acc: 85.870% (8587/10000) 100/100 

Epoch: 94
 [================================================================>]  Step: 71ms | Tot: 45s479ms | Loss: 0.201 | Acc: 93.086% (46543/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 3s995ms | Loss: 0.433 | Acc: 86.080% (8608/10000) 100/100 

Epoch: 95
 [================================================================>]  Step: 85ms | Tot: 45s448ms | Loss: 0.204 | Acc: 93.018% (46509/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s42ms | Loss: 0.419 | Acc: 86.680% (8668/10000) 100/100 

Epoch: 96
 [================================================================>]  Step: 79ms | Tot: 44s735ms | Loss: 0.199 | Acc: 93.312% (46656/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s91ms | Loss: 0.373 | Acc: 88.120% (8812/10000) 100/100 

Epoch: 97
 [================================================================>]  Step: 77ms | Tot: 45s272ms | Loss: 0.201 | Acc: 93.090% (46545/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s341ms | Loss: 0.346 | Acc: 88.750% (8875/10000) 100/100 

Epoch: 98
 [================================================================>]  Step: 86ms | Tot: 46s281ms | Loss: 0.194 | Acc: 93.302% (46651/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s326ms | Loss: 0.361 | Acc: 88.900% (8890/10000) 100/100 

Epoch: 99
 [================================================================>]  Step: 81ms | Tot: 45s967ms | Loss: 0.194 | Acc: 93.404% (46702/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s283ms | Loss: 0.435 | Acc: 85.900% (8590/10000) 100/100 

Epoch: 100
 [================================================================>]  Step: 87ms | Tot: 45s623ms | Loss: 0.186 | Acc: 93.750% (46875/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s130ms | Loss: 0.402 | Acc: 87.120% (8712/10000) 100/100 

Epoch: 101
 [================================================================>]  Step: 80ms | Tot: 45s853ms | Loss: 0.186 | Acc: 93.626% (46813/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s273ms | Loss: 0.348 | Acc: 88.800% (8880/10000) 100/100 

Epoch: 102
 [================================================================>]  Step: 73ms | Tot: 46s64ms | Loss: 0.187 | Acc: 93.598% (46799/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s340ms | Loss: 0.315 | Acc: 89.910% (8991/10000) 100/100 
Saving..

Epoch: 103
 [================================================================>]  Step: 74ms | Tot: 45s768ms | Loss: 0.184 | Acc: 93.740% (46870/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s285ms | Loss: 0.335 | Acc: 89.480% (8948/10000) 100/100 

Epoch: 104
 [================================================================>]  Step: 72ms | Tot: 45s404ms | Loss: 0.178 | Acc: 93.878% (46939/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s197ms | Loss: 0.326 | Acc: 89.520% (8952/10000) 100/100 

Epoch: 105
 [================================================================>]  Step: 69ms | Tot: 45s657ms | Loss: 0.172 | Acc: 94.218% (47109/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s201ms | Loss: 0.302 | Acc: 90.540% (9054/10000) 100/100 
Saving..

Epoch: 106
 [================================================================>]  Step: 84ms | Tot: 45s688ms | Loss: 0.171 | Acc: 94.262% (47131/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s231ms | Loss: 0.361 | Acc: 88.860% (8886/10000) 100/100 

Epoch: 107
 [================================================================>]  Step: 77ms | Tot: 45s771ms | Loss: 0.167 | Acc: 94.366% (47183/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s99ms | Loss: 0.322 | Acc: 89.730% (8973/10000) 100/100 

Epoch: 108
 [================================================================>]  Step: 82ms | Tot: 45s783ms | Loss: 0.165 | Acc: 94.376% (47188/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s246ms | Loss: 0.342 | Acc: 88.980% (8898/10000) 100/100 

Epoch: 109
 [================================================================>]  Step: 80ms | Tot: 45s790ms | Loss: 0.165 | Acc: 94.462% (47231/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s207ms | Loss: 0.326 | Acc: 89.790% (8979/10000) 100/100 

Epoch: 110
 [================================================================>]  Step: 80ms | Tot: 45s737ms | Loss: 0.164 | Acc: 94.446% (47223/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s327ms | Loss: 0.337 | Acc: 89.550% (8955/10000) 100/100 

Epoch: 111
 [================================================================>]  Step: 73ms | Tot: 45s548ms | Loss: 0.162 | Acc: 94.416% (47208/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s789ms | Loss: 0.354 | Acc: 89.070% (8907/10000) 100/100 

Epoch: 112
 [================================================================>]  Step: 78ms | Tot: 45s427ms | Loss: 0.157 | Acc: 94.562% (47281/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s194ms | Loss: 0.360 | Acc: 88.260% (8826/10000) 100/100 

Epoch: 113
 [================================================================>]  Step: 91ms | Tot: 45s957ms | Loss: 0.156 | Acc: 94.652% (47326/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s268ms | Loss: 0.325 | Acc: 89.900% (8990/10000) 100/100 

Epoch: 114
 [================================================================>]  Step: 82ms | Tot: 46s168ms | Loss: 0.147 | Acc: 94.966% (47483/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 4s304ms | Loss: 0.327 | Acc: 89.810% (8981/10000) 100/100 

Epoch: 115
 [================================================================>]  Step: 72ms | Tot: 45s707ms | Loss: 0.155 | Acc: 94.794% (47397/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s731ms | Loss: 0.349 | Acc: 89.490% (8949/10000) 100/100 

Epoch: 116
 [================================================================>]  Step: 96ms | Tot: 45s463ms | Loss: 0.138 | Acc: 95.322% (47661/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s178ms | Loss: 0.318 | Acc: 90.160% (9016/10000) 100/100 

Epoch: 117
 [================================================================>]  Step: 74ms | Tot: 45s877ms | Loss: 0.144 | Acc: 95.122% (47561/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s287ms | Loss: 0.297 | Acc: 90.780% (9078/10000) 100/100 
Saving..

Epoch: 118
 [================================================================>]  Step: 82ms | Tot: 45s918ms | Loss: 0.140 | Acc: 95.268% (47634/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s136ms | Loss: 0.345 | Acc: 89.620% (8962/10000) 100/100 

Epoch: 119
 [================================================================>]  Step: 89ms | Tot: 45s711ms | Loss: 0.138 | Acc: 95.216% (47608/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s262ms | Loss: 0.293 | Acc: 90.800% (9080/10000) 100/100 
Saving..

Epoch: 120
 [================================================================>]  Step: 85ms | Tot: 46s | Loss: 0.128 | Acc: 95.606% (47803/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s300ms | Loss: 0.286 | Acc: 91.170% (9117/10000) 100/100 
Saving..

Epoch: 121
 [================================================================>]  Step: 79ms | Tot: 46s126ms | Loss: 0.131 | Acc: 95.448% (47724/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s403ms | Loss: 0.326 | Acc: 89.750% (8975/10000) 100/100 

Epoch: 122
 [================================================================>]  Step: 81ms | Tot: 46s506ms | Loss: 0.129 | Acc: 95.592% (47796/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s438ms | Loss: 0.334 | Acc: 89.720% (8972/10000) 100/100 

Epoch: 123
 [================================================================>]  Step: 74ms | Tot: 45s776ms | Loss: 0.121 | Acc: 95.930% (47965/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s262ms | Loss: 0.302 | Acc: 90.580% (9058/10000) 100/100 

Epoch: 124
 [================================================================>]  Step: 76ms | Tot: 45s579ms | Loss: 0.122 | Acc: 95.944% (47972/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s276ms | Loss: 0.292 | Acc: 91.080% (9108/10000) 100/100 

Epoch: 125
 [================================================================>]  Step: 83ms | Tot: 46s472ms | Loss: 0.122 | Acc: 95.820% (47910/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s449ms | Loss: 0.307 | Acc: 91.060% (9106/10000) 100/100 

Epoch: 126
 [================================================================>]  Step: 80ms | Tot: 45s635ms | Loss: 0.112 | Acc: 96.242% (48121/50000) 391/391 
 [================================================================>]  Step: 27ms | Tot: 4s267ms | Loss: 0.306 | Acc: 90.600% (9060/10000) 100/100 

Epoch: 127
 [================================================================>]  Step: 72ms | Tot: 46s166ms | Loss: 0.112 | Acc: 96.180% (48090/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s224ms | Loss: 0.282 | Acc: 91.560% (9156/10000) 100/100 
Saving..

Epoch: 128
 [================================================================>]  Step: 80ms | Tot: 46s18ms | Loss: 0.113 | Acc: 96.164% (48082/50000) 391/391 
 [================================================================>]  Step: 26ms | Tot: 4s388ms | Loss: 0.298 | Acc: 91.250% (9125/10000) 100/100 

Epoch: 129
 [================================================================>]  Step: 74ms | Tot: 45s997ms | Loss: 0.105 | Acc: 96.416% (48208/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s482ms | Loss: 0.338 | Acc: 89.560% (8956/10000) 100/100 

Epoch: 130
 [================================================================>]  Step: 97ms | Tot: 45s705ms | Loss: 0.103 | Acc: 96.546% (48273/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s344ms | Loss: 0.284 | Acc: 91.410% (9141/10000) 100/100 

Epoch: 131
 [================================================================>]  Step: 84ms | Tot: 45s418ms | Loss: 0.101 | Acc: 96.578% (48289/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s352ms | Loss: 0.330 | Acc: 90.170% (9017/10000) 100/100 

Epoch: 132
 [================================================================>]  Step: 81ms | Tot: 45s989ms | Loss: 0.099 | Acc: 96.634% (48317/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s378ms | Loss: 0.326 | Acc: 90.250% (9025/10000) 100/100 

Epoch: 133
 [================================================================>]  Step: 84ms | Tot: 45s490ms | Loss: 0.088 | Acc: 97.022% (48511/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s312ms | Loss: 0.316 | Acc: 90.470% (9047/10000) 100/100 

Epoch: 134
 [================================================================>]  Step: 75ms | Tot: 46s11ms | Loss: 0.090 | Acc: 96.940% (48470/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s348ms | Loss: 0.364 | Acc: 89.330% (8933/10000) 100/100 

Epoch: 135
 [================================================================>]  Step: 74ms | Tot: 45s919ms | Loss: 0.090 | Acc: 96.982% (48491/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s243ms | Loss: 0.351 | Acc: 90.240% (9024/10000) 100/100 

Epoch: 136
 [================================================================>]  Step: 82ms | Tot: 46s5ms | Loss: 0.087 | Acc: 97.004% (48502/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s876ms | Loss: 0.300 | Acc: 91.160% (9116/10000) 100/100 

Epoch: 137
 [================================================================>]  Step: 79ms | Tot: 45s695ms | Loss: 0.081 | Acc: 97.292% (48646/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s333ms | Loss: 0.311 | Acc: 90.920% (9092/10000) 100/100 

Epoch: 138
 [================================================================>]  Step: 82ms | Tot: 46s218ms | Loss: 0.080 | Acc: 97.302% (48651/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s405ms | Loss: 0.336 | Acc: 90.360% (9036/10000) 100/100 

Epoch: 139
 [================================================================>]  Step: 84ms | Tot: 46s68ms | Loss: 0.078 | Acc: 97.346% (48673/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s302ms | Loss: 0.338 | Acc: 90.420% (9042/10000) 100/100 

Epoch: 140
 [================================================================>]  Step: 84ms | Tot: 45s567ms | Loss: 0.072 | Acc: 97.538% (48769/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s380ms | Loss: 0.277 | Acc: 91.790% (9179/10000) 100/100 
Saving..

Epoch: 141
 [================================================================>]  Step: 83ms | Tot: 46s283ms | Loss: 0.081 | Acc: 97.240% (48620/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s308ms | Loss: 0.273 | Acc: 91.860% (9186/10000) 100/100 
Saving..

Epoch: 142
 [================================================================>]  Step: 76ms | Tot: 46s83ms | Loss: 0.066 | Acc: 97.744% (48872/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s262ms | Loss: 0.287 | Acc: 91.750% (9175/10000) 100/100 

Epoch: 143
 [================================================================>]  Step: 91ms | Tot: 45s880ms | Loss: 0.069 | Acc: 97.658% (48829/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s469ms | Loss: 0.297 | Acc: 91.310% (9131/10000) 100/100 

Epoch: 144
 [================================================================>]  Step: 74ms | Tot: 46s222ms | Loss: 0.066 | Acc: 97.778% (48889/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s513ms | Loss: 0.288 | Acc: 91.500% (9150/10000) 100/100 

Epoch: 145
 [================================================================>]  Step: 93ms | Tot: 46s185ms | Loss: 0.058 | Acc: 98.096% (49048/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s349ms | Loss: 0.251 | Acc: 92.900% (9290/10000) 100/100 
Saving..

Epoch: 146
 [================================================================>]  Step: 68ms | Tot: 46s38ms | Loss: 0.060 | Acc: 97.960% (48980/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 5s80ms | Loss: 0.262 | Acc: 92.290% (9229/10000) 100/100 

Epoch: 147
 [================================================================>]  Step: 86ms | Tot: 45s835ms | Loss: 0.049 | Acc: 98.416% (49208/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s404ms | Loss: 0.256 | Acc: 92.460% (9246/10000) 100/100 

Epoch: 148
 [================================================================>]  Step: 75ms | Tot: 45s982ms | Loss: 0.051 | Acc: 98.352% (49176/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s418ms | Loss: 0.314 | Acc: 91.360% (9136/10000) 100/100 

Epoch: 149
 [================================================================>]  Step: 81ms | Tot: 46s275ms | Loss: 0.052 | Acc: 98.302% (49151/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s439ms | Loss: 0.270 | Acc: 92.600% (9260/10000) 100/100 

Epoch: 150
 [================================================================>]  Step: 82ms | Tot: 46s110ms | Loss: 0.045 | Acc: 98.574% (49287/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s343ms | Loss: 0.303 | Acc: 91.680% (9168/10000) 100/100 

Epoch: 151
 [================================================================>]  Step: 77ms | Tot: 46s118ms | Loss: 0.047 | Acc: 98.434% (49217/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s327ms | Loss: 0.282 | Acc: 92.370% (9237/10000) 100/100 

Epoch: 152
 [================================================================>]  Step: 81ms | Tot: 46s80ms | Loss: 0.043 | Acc: 98.634% (49317/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s339ms | Loss: 0.288 | Acc: 92.230% (9223/10000) 100/100 

Epoch: 153
 [================================================================>]  Step: 91ms | Tot: 45s761ms | Loss: 0.038 | Acc: 98.752% (49376/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s355ms | Loss: 0.323 | Acc: 91.710% (9171/10000) 100/100 

Epoch: 154
 [================================================================>]  Step: 92ms | Tot: 46s380ms | Loss: 0.037 | Acc: 98.850% (49425/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s339ms | Loss: 0.260 | Acc: 93.010% (9301/10000) 100/100 
Saving..

Epoch: 155
 [================================================================>]  Step: 89ms | Tot: 46s191ms | Loss: 0.034 | Acc: 98.924% (49462/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s465ms | Loss: 0.259 | Acc: 93.070% (9307/10000) 100/100 
Saving..

Epoch: 156
 [================================================================>]  Step: 79ms | Tot: 46s229ms | Loss: 0.026 | Acc: 99.170% (49585/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s427ms | Loss: 0.270 | Acc: 92.960% (9296/10000) 100/100 

Epoch: 157
 [================================================================>]  Step: 80ms | Tot: 45s944ms | Loss: 0.031 | Acc: 99.022% (49511/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s305ms | Loss: 0.262 | Acc: 93.250% (9325/10000) 100/100 
Saving..

Epoch: 158
 [================================================================>]  Step: 74ms | Tot: 46s292ms | Loss: 0.025 | Acc: 99.284% (49642/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s474ms | Loss: 0.249 | Acc: 93.130% (9313/10000) 100/100 

Epoch: 159
 [================================================================>]  Step: 81ms | Tot: 46s354ms | Loss: 0.023 | Acc: 99.312% (49656/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s438ms | Loss: 0.235 | Acc: 93.630% (9363/10000) 100/100 
Saving..

Epoch: 160
 [================================================================>]  Step: 75ms | Tot: 46s723ms | Loss: 0.023 | Acc: 99.284% (49642/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s382ms | Loss: 0.247 | Acc: 93.440% (9344/10000) 100/100 

Epoch: 161
 [================================================================>]  Step: 71ms | Tot: 46s359ms | Loss: 0.021 | Acc: 99.336% (49668/50000) 391/391 
 [================================================================>]  Step: 27ms | Tot: 4s395ms | Loss: 0.239 | Acc: 93.400% (9340/10000) 100/100 

Epoch: 162
 [================================================================>]  Step: 71ms | Tot: 46s321ms | Loss: 0.019 | Acc: 99.408% (49704/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s540ms | Loss: 0.245 | Acc: 93.250% (9325/10000) 100/100 

Epoch: 163
 [================================================================>]  Step: 73ms | Tot: 46s215ms | Loss: 0.017 | Acc: 99.490% (49745/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s424ms | Loss: 0.243 | Acc: 93.590% (9359/10000) 100/100 

Epoch: 164
 [================================================================>]  Step: 81ms | Tot: 46s806ms | Loss: 0.014 | Acc: 99.600% (49800/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s487ms | Loss: 0.226 | Acc: 94.100% (9410/10000) 100/100 
Saving..

Epoch: 165
 [================================================================>]  Step: 82ms | Tot: 46s419ms | Loss: 0.010 | Acc: 99.738% (49869/50000) 391/391 
 [================================================================>]  Step: 26ms | Tot: 4s381ms | Loss: 0.228 | Acc: 94.010% (9401/10000) 100/100 

Epoch: 166
 [================================================================>]  Step: 83ms | Tot: 46s670ms | Loss: 0.009 | Acc: 99.756% (49878/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s370ms | Loss: 0.219 | Acc: 94.260% (9426/10000) 100/100 
Saving..

Epoch: 167
 [================================================================>]  Step: 80ms | Tot: 46s199ms | Loss: 0.007 | Acc: 99.838% (49919/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s333ms | Loss: 0.225 | Acc: 94.170% (9417/10000) 100/100 

Epoch: 168
 [================================================================>]  Step: 93ms | Tot: 46s503ms | Loss: 0.008 | Acc: 99.800% (49900/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s617ms | Loss: 0.212 | Acc: 94.530% (9453/10000) 100/100 
Saving..

Epoch: 169
 [================================================================>]  Step: 82ms | Tot: 46s776ms | Loss: 0.005 | Acc: 99.888% (49944/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s456ms | Loss: 0.207 | Acc: 94.600% (9460/10000) 100/100 
Saving..

Epoch: 170
 [================================================================>]  Step: 89ms | Tot: 46s54ms | Loss: 0.006 | Acc: 99.856% (49928/50000) 391/391 
 [================================================================>]  Step: 57ms | Tot: 5s42ms | Loss: 0.208 | Acc: 94.620% (9462/10000) 100/100 
Saving..

Epoch: 171
 [================================================================>]  Step: 81ms | Tot: 46s816ms | Loss: 0.005 | Acc: 99.910% (49955/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s539ms | Loss: 0.206 | Acc: 94.750% (9475/10000) 100/100 
Saving..

Epoch: 172
 [================================================================>]  Step: 81ms | Tot: 46s446ms | Loss: 0.004 | Acc: 99.946% (49973/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 4s370ms | Loss: 0.193 | Acc: 95.050% (9505/10000) 100/100 
Saving..

Epoch: 173
 [================================================================>]  Step: 75ms | Tot: 46s287ms | Loss: 0.003 | Acc: 99.956% (49978/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s549ms | Loss: 0.192 | Acc: 94.970% (9497/10000) 100/100 

Epoch: 174
 [================================================================>]  Step: 83ms | Tot: 46s771ms | Loss: 0.003 | Acc: 99.972% (49986/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s625ms | Loss: 0.196 | Acc: 95.040% (9504/10000) 100/100 

Epoch: 175
 [================================================================>]  Step: 80ms | Tot: 46s394ms | Loss: 0.003 | Acc: 99.968% (49984/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s429ms | Loss: 0.193 | Acc: 95.110% (9511/10000) 100/100 
Saving..

Epoch: 176
 [================================================================>]  Step: 80ms | Tot: 46s845ms | Loss: 0.002 | Acc: 99.974% (49987/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s458ms | Loss: 0.197 | Acc: 95.010% (9501/10000) 100/100 

Epoch: 177
 [================================================================>]  Step: 82ms | Tot: 46s521ms | Loss: 0.002 | Acc: 99.978% (49989/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s577ms | Loss: 0.189 | Acc: 95.110% (9511/10000) 100/100 

Epoch: 178
 [================================================================>]  Step: 76ms | Tot: 47s196ms | Loss: 0.002 | Acc: 99.988% (49994/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s498ms | Loss: 0.186 | Acc: 95.260% (9526/10000) 100/100 
Saving..

Epoch: 179
 [================================================================>]  Step: 82ms | Tot: 47s334ms | Loss: 0.002 | Acc: 99.988% (49994/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s471ms | Loss: 0.183 | Acc: 95.210% (9521/10000) 100/100 

Epoch: 180
 [================================================================>]  Step: 84ms | Tot: 46s831ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s395ms | Loss: 0.183 | Acc: 95.260% (9526/10000) 100/100 

Epoch: 181
 [================================================================>]  Step: 87ms | Tot: 46s881ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s473ms | Loss: 0.182 | Acc: 95.220% (9522/10000) 100/100 

Epoch: 182
 [================================================================>]  Step: 91ms | Tot: 46s620ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s519ms | Loss: 0.182 | Acc: 95.130% (9513/10000) 100/100 

Epoch: 183
 [================================================================>]  Step: 69ms | Tot: 46s845ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s419ms | Loss: 0.183 | Acc: 95.070% (9507/10000) 100/100 

Epoch: 184
 [================================================================>]  Step: 75ms | Tot: 46s550ms | Loss: 0.002 | Acc: 99.988% (49994/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s489ms | Loss: 0.180 | Acc: 95.200% (9520/10000) 100/100 

Epoch: 185
 [================================================================>]  Step: 82ms | Tot: 46s350ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s452ms | Loss: 0.182 | Acc: 95.220% (9522/10000) 100/100 

Epoch: 186
 [================================================================>]  Step: 80ms | Tot: 46s382ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s564ms | Loss: 0.179 | Acc: 95.140% (9514/10000) 100/100 

Epoch: 187
 [================================================================>]  Step: 82ms | Tot: 46s337ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s465ms | Loss: 0.178 | Acc: 95.250% (9525/10000) 100/100 

Epoch: 188
 [================================================================>]  Step: 83ms | Tot: 46s486ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s529ms | Loss: 0.178 | Acc: 95.260% (9526/10000) 100/100 

Epoch: 189
 [================================================================>]  Step: 87ms | Tot: 46s613ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s723ms | Loss: 0.180 | Acc: 95.190% (9519/10000) 100/100 

Epoch: 190
 [================================================================>]  Step: 81ms | Tot: 46s321ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s528ms | Loss: 0.179 | Acc: 95.200% (9520/10000) 100/100 

Epoch: 191
 [================================================================>]  Step: 77ms | Tot: 46s597ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s460ms | Loss: 0.179 | Acc: 95.240% (9524/10000) 100/100 

Epoch: 192
 [================================================================>]  Step: 85ms | Tot: 46s609ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s580ms | Loss: 0.179 | Acc: 95.250% (9525/10000) 100/100 

Epoch: 193
 [================================================================>]  Step: 75ms | Tot: 47s15ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s629ms | Loss: 0.176 | Acc: 95.280% (9528/10000) 100/100 
Saving..

Epoch: 194
 [================================================================>]  Step: 87ms | Tot: 46s384ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s577ms | Loss: 0.179 | Acc: 95.210% (9521/10000) 100/100 

Epoch: 195
 [================================================================>]  Step: 86ms | Tot: 46s726ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s476ms | Loss: 0.177 | Acc: 95.260% (9526/10000) 100/100 

Epoch: 196
 [================================================================>]  Step: 90ms | Tot: 47s145ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s618ms | Loss: 0.178 | Acc: 95.280% (9528/10000) 100/100 

Epoch: 197
 [================================================================>]  Step: 87ms | Tot: 46s888ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s598ms | Loss: 0.178 | Acc: 95.190% (9519/10000) 100/100 

Epoch: 198
 [================================================================>]  Step: 71ms | Tot: 46s901ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s654ms | Loss: 0.177 | Acc: 95.210% (9521/10000) 100/100 

Epoch: 199
 [================================================================>]  Step: 75ms | Tot: 47s171ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s662ms | Loss: 0.177 | Acc: 95.220% (9522/10000) 100/100 

Epoch: 200
 [================================================================>]  Step: 83ms | Tot: 46s893ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s573ms | Loss: 0.179 | Acc: 95.220% (9522/10000) 100/100 

Epoch: 201
 [================================================================>]  Step: 77ms | Tot: 46s361ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 5s25ms | Loss: 0.177 | Acc: 95.230% (9523/10000) 100/100 

Epoch: 202
 [================================================================>]  Step: 77ms | Tot: 46s667ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s549ms | Loss: 0.177 | Acc: 95.290% (9529/10000) 100/100 
Saving..

Epoch: 203
 [================================================================>]  Step: 84ms | Tot: 46s639ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s569ms | Loss: 0.178 | Acc: 95.250% (9525/10000) 100/100 

Epoch: 204
 [================================================================>]  Step: 75ms | Tot: 46s347ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s490ms | Loss: 0.177 | Acc: 95.290% (9529/10000) 100/100 

Epoch: 205
 [================================================================>]  Step: 87ms | Tot: 46s369ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 78ms | Tot: 4s433ms | Loss: 0.178 | Acc: 95.210% (9521/10000) 100/100 

Epoch: 206
 [================================================================>]  Step: 92ms | Tot: 46s804ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s635ms | Loss: 0.178 | Acc: 95.280% (9528/10000) 100/100 

Epoch: 207
 [================================================================>]  Step: 74ms | Tot: 46s494ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s579ms | Loss: 0.178 | Acc: 95.260% (9526/10000) 100/100 

Epoch: 208
 [================================================================>]  Step: 89ms | Tot: 46s499ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 51ms | Tot: 5s107ms | Loss: 0.178 | Acc: 95.230% (9523/10000) 100/100 

Epoch: 209
 [================================================================>]  Step: 87ms | Tot: 46s513ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s595ms | Loss: 0.178 | Acc: 95.200% (9520/10000) 100/100 

Epoch: 210
 [================================================================>]  Step: 77ms | Tot: 46s538ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s503ms | Loss: 0.178 | Acc: 95.330% (9533/10000) 100/100 
Saving..

Epoch: 211
 [================================================================>]  Step: 78ms | Tot: 46s660ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 51ms | Tot: 4s446ms | Loss: 0.179 | Acc: 95.300% (9530/10000) 100/100 

Epoch: 212
 [================================================================>]  Step: 68ms | Tot: 46s369ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s605ms | Loss: 0.177 | Acc: 95.340% (9534/10000) 100/100 
Saving..

Epoch: 213
 [================================================================>]  Step: 87ms | Tot: 46s691ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s462ms | Loss: 0.177 | Acc: 95.340% (9534/10000) 100/100 

Epoch: 214
 [================================================================>]  Step: 75ms | Tot: 46s561ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s566ms | Loss: 0.176 | Acc: 95.280% (9528/10000) 100/100 

Epoch: 215
 [================================================================>]  Step: 86ms | Tot: 46s432ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 5s125ms | Loss: 0.177 | Acc: 95.290% (9529/10000) 100/100 

Epoch: 216
 [================================================================>]  Step: 77ms | Tot: 46s322ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 98ms | Tot: 4s417ms | Loss: 0.177 | Acc: 95.300% (9530/10000) 100/100 

Epoch: 217
 [================================================================>]  Step: 84ms | Tot: 46s610ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s659ms | Loss: 0.178 | Acc: 95.240% (9524/10000) 100/100 

Epoch: 218
 [================================================================>]  Step: 82ms | Tot: 47s24ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s468ms | Loss: 0.177 | Acc: 95.320% (9532/10000) 100/100 

Epoch: 219
 [================================================================>]  Step: 79ms | Tot: 46s489ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s470ms | Loss: 0.175 | Acc: 95.350% (9535/10000) 100/100 
Saving..

Epoch: 220
 [================================================================>]  Step: 87ms | Tot: 46s849ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s519ms | Loss: 0.178 | Acc: 95.240% (9524/10000) 100/100 

Epoch: 221
 [================================================================>]  Step: 73ms | Tot: 46s867ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s651ms | Loss: 0.179 | Acc: 95.180% (9518/10000) 100/100 

Epoch: 222
 [================================================================>]  Step: 73ms | Tot: 46s680ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s517ms | Loss: 0.178 | Acc: 95.280% (9528/10000) 100/100 

Epoch: 223
 [================================================================>]  Step: 86ms | Tot: 46s321ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s522ms | Loss: 0.179 | Acc: 95.240% (9524/10000) 100/100 

Epoch: 224
 [================================================================>]  Step: 91ms | Tot: 46s723ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s595ms | Loss: 0.178 | Acc: 95.280% (9528/10000) 100/100 

Epoch: 225
 [================================================================>]  Step: 90ms | Tot: 46s752ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s456ms | Loss: 0.178 | Acc: 95.310% (9531/10000) 100/100 

Epoch: 226
 [================================================================>]  Step: 76ms | Tot: 46s776ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s950ms | Loss: 0.179 | Acc: 95.210% (9521/10000) 100/100 

Epoch: 227
 [================================================================>]  Step: 77ms | Tot: 46s110ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s553ms | Loss: 0.184 | Acc: 95.010% (9501/10000) 100/100 

Epoch: 228
 [================================================================>]  Step: 70ms | Tot: 46s741ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 53ms | Tot: 4s606ms | Loss: 0.188 | Acc: 95.090% (9509/10000) 100/100 

Epoch: 229
 [================================================================>]  Step: 75ms | Tot: 47s140ms | Loss: 0.003 | Acc: 99.952% (49976/50000) 391/391 
 [================================================================>]  Step: 81ms | Tot: 4s441ms | Loss: 0.208 | Acc: 94.560% (9456/10000) 100/100 

Epoch: 230
 [================================================================>]  Step: 81ms | Tot: 46s254ms | Loss: 0.007 | Acc: 99.842% (49921/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s887ms | Loss: 0.246 | Acc: 93.750% (9375/10000) 100/100 

Epoch: 231
 [================================================================>]  Step: 88ms | Tot: 46s356ms | Loss: 0.025 | Acc: 99.256% (49628/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s559ms | Loss: 0.266 | Acc: 92.810% (9281/10000) 100/100 

Epoch: 232
 [================================================================>]  Step: 72ms | Tot: 46s767ms | Loss: 0.049 | Acc: 98.368% (49184/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s551ms | Loss: 0.280 | Acc: 92.130% (9213/10000) 100/100 

Epoch: 233
 [================================================================>]  Step: 88ms | Tot: 46s760ms | Loss: 0.052 | Acc: 98.322% (49161/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s501ms | Loss: 0.330 | Acc: 90.810% (9081/10000) 100/100 

Epoch: 234
 [================================================================>]  Step: 81ms | Tot: 46s414ms | Loss: 0.057 | Acc: 98.052% (49026/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s506ms | Loss: 0.311 | Acc: 91.270% (9127/10000) 100/100 

Epoch: 235
 [================================================================>]  Step: 91ms | Tot: 46s506ms | Loss: 0.062 | Acc: 98.006% (49003/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s593ms | Loss: 0.313 | Acc: 91.290% (9129/10000) 100/100 

Epoch: 236
 [================================================================>]  Step: 73ms | Tot: 46s919ms | Loss: 0.065 | Acc: 97.848% (48924/50000) 391/391 
 [================================================================>]  Step: 55ms | Tot: 4s599ms | Loss: 0.292 | Acc: 91.310% (9131/10000) 100/100 

Epoch: 237
 [================================================================>]  Step: 96ms | Tot: 46s762ms | Loss: 0.069 | Acc: 97.794% (48897/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s587ms | Loss: 0.300 | Acc: 91.360% (9136/10000) 100/100 

Epoch: 238
 [================================================================>]  Step: 77ms | Tot: 46s786ms | Loss: 0.065 | Acc: 97.900% (48950/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s538ms | Loss: 0.307 | Acc: 91.540% (9154/10000) 100/100 

Epoch: 239
 [================================================================>]  Step: 67ms | Tot: 46s628ms | Loss: 0.068 | Acc: 97.734% (48867/50000) 391/391 
 [================================================================>]  Step: 27ms | Tot: 4s547ms | Loss: 0.253 | Acc: 92.630% (9263/10000) 100/100 

Epoch: 240
 [================================================================>]  Step: 82ms | Tot: 46s498ms | Loss: 0.072 | Acc: 97.572% (48786/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s553ms | Loss: 0.285 | Acc: 91.850% (9185/10000) 100/100 

Epoch: 241
 [================================================================>]  Step: 77ms | Tot: 46s407ms | Loss: 0.079 | Acc: 97.358% (48679/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s763ms | Loss: 0.325 | Acc: 90.690% (9069/10000) 100/100 

Epoch: 242
 [================================================================>]  Step: 83ms | Tot: 46s359ms | Loss: 0.072 | Acc: 97.610% (48805/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s588ms | Loss: 0.284 | Acc: 91.780% (9178/10000) 100/100 

Epoch: 243
 [================================================================>]  Step: 74ms | Tot: 46s266ms | Loss: 0.074 | Acc: 97.478% (48739/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s418ms | Loss: 0.293 | Acc: 91.810% (9181/10000) 100/100 

Epoch: 244
 [================================================================>]  Step: 78ms | Tot: 46s514ms | Loss: 0.077 | Acc: 97.326% (48663/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s567ms | Loss: 0.274 | Acc: 91.980% (9198/10000) 100/100 

Epoch: 245
 [================================================================>]  Step: 76ms | Tot: 46s659ms | Loss: 0.070 | Acc: 97.702% (48851/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 5s175ms | Loss: 0.303 | Acc: 91.580% (9158/10000) 100/100 

Epoch: 246
 [================================================================>]  Step: 90ms | Tot: 46s639ms | Loss: 0.081 | Acc: 97.366% (48683/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s520ms | Loss: 0.275 | Acc: 92.280% (9228/10000) 100/100 

Epoch: 247
 [================================================================>]  Step: 75ms | Tot: 46s714ms | Loss: 0.077 | Acc: 97.428% (48714/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s665ms | Loss: 0.292 | Acc: 91.530% (9153/10000) 100/100 

Epoch: 248
 [================================================================>]  Step: 87ms | Tot: 46s948ms | Loss: 0.076 | Acc: 97.512% (48756/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s672ms | Loss: 0.307 | Acc: 91.430% (9143/10000) 100/100 

Epoch: 249
 [================================================================>]  Step: 85ms | Tot: 47s51ms | Loss: 0.078 | Acc: 97.386% (48693/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 5s355ms | Loss: 0.306 | Acc: 91.880% (9188/10000) 100/100 