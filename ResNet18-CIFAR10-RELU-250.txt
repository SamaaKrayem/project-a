import torch
import torch.nn as nn
import torch.nn.functional as F
import numpy as np
import warnings
from typing import Optional, Tuple

import torch
from torch import Tensor
from torch.nn.init import constant_, xavier_normal_, xavier_uniform_
from torch.nn.parameter import Parameter
import torch.autograd
from torch import autograd

sm_alpha=0

def SMrelu_forward(z: Tensor, alpha: float):
    relu_positive = z
    relu_zero = 0
    relu_output = torch.where(z>0, relu_positive, relu_zero)
    return relu_output
  

class SMRELUFunction(torch.autograd.Function):
    
    @staticmethod
    def forward(ctx, z: Tensor, alpha: float):
        relu = SMrelu_forward(z, alpha) # Regular forward pass computation from before
        ctx.save_for_backward(z)    # Tensors should be saved using this method
        ctx.alpha = alpha           # other properties can be saved like so
        return relu
    
    @staticmethod
    def backward(ctx, grad_output):
        z, = ctx.saved_tensors      # Validates that no in-place modifications happened on saved tensors
        alpha = ctx.alpha
        
        # Calculate diagonal of d(elu(z))/dz
        grad_positive = torch.ones_like(z)
        grad_zero = 0
        
        # Note: This is not the full Jacobian, d(elu(z))/dz, it's the diagonal
        grad_SMrelu = torch.where(z > ((-1)*alpha), grad_positive, grad_zero)
        
        # Gradient of the loss w.r.t. our output
        δ_smrelu = grad_output
        
        # Calcualte δz = d(elu(z))/dz * δ_elu
        # Note: elementwise multiplication equivalant to vector-Jacobian product
        δz = grad_SMrelu * δ_smrelu
        return δz, None

class BasicBlock(nn.Module):
    expansion = 1

    def __init__(self, in_planes, planes, stride=1):
        super(BasicBlock, self).__init__()
        self.conv1 = nn.Conv2d(
            in_planes, planes, kernel_size=3, stride=stride, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(planes)
        self.conv2 = nn.Conv2d(planes, planes, kernel_size=3,
                               stride=1, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(planes)

        self.shortcut = nn.Sequential()
        if stride != 1 or in_planes != self.expansion*planes:
            self.shortcut = nn.Sequential(
                nn.Conv2d(in_planes, self.expansion*planes,
                          kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm2d(self.expansion*planes)
            )

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = self.bn2(self.conv2(out))
        out += self.shortcut(x)
        out = SMRELUFunction.apply(out,sm_alpha)
        return out

class Bottleneck(nn.Module):
    expansion = 4

    def __init__(self, in_planes, planes, stride=1):
        super(Bottleneck, self).__init__()
        self.conv1 = nn.Conv2d(in_planes, planes, kernel_size=1, bias=False)
        self.bn1 = nn.BatchNorm2d(planes)
        self.conv2 = nn.Conv2d(planes, planes, kernel_size=3,
                               stride=stride, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(planes)
        self.conv3 = nn.Conv2d(planes, self.expansion *
                               planes, kernel_size=1, bias=False)
        self.bn3 = nn.BatchNorm2d(self.expansion*planes)

        self.shortcut = nn.Sequential()
        if stride != 1 or in_planes != self.expansion*planes:
            self.shortcut = nn.Sequential(
                nn.Conv2d(in_planes, self.expansion*planes,
                          kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm2d(self.expansion*planes)
            )

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = SMRELUFunction.apply(self.bn2(self.conv2(out)),sm_alpha)
        out = self.bn3(self.conv3(out))
        out += self.shortcut(x)
        out = SMRELUFunction.apply(out,sm_alpha)
        return out

class ResNet(nn.Module):
    def __init__(self, block, num_blocks, num_classes=10):
        super(ResNet, self).__init__()
        self.in_planes = 64

        self.conv1 = nn.Conv2d(3, 64, kernel_size=3,
                               stride=1, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(64)
        self.layer1 = self._make_layer(block, 64, num_blocks[0], stride=1)
        self.layer2 = self._make_layer(block, 128, num_blocks[1], stride=2)
        self.layer3 = self._make_layer(block, 256, num_blocks[2], stride=2)
        self.layer4 = self._make_layer(block, 512, num_blocks[3], stride=2)
        self.linear = nn.Linear(512*block.expansion, num_classes)

    def _make_layer(self, block, planes, num_blocks, stride):
        strides = [stride] + [1]*(num_blocks-1)
        layers = []
        for stride in strides:
            layers.append(block(self.in_planes, planes, stride))
            self.in_planes = planes * block.expansion
        return nn.Sequential(*layers)

    def forward(self, x):
        out = SMRELUFunction.apply(self.bn1(self.conv1(x)),sm_alpha)
        out = self.layer1(out)
        out = self.layer2(out)
        out = self.layer3(out)
        out = self.layer4(out)
        out = F.avg_pool2d(out, 4)
        out = out.view(out.size(0), -1)
        out = self.linear(out)
        return out

def ResNet18():
    return ResNet(BasicBlock, [2, 2, 2, 2])


def ResNet34():
    return ResNet(BasicBlock, [3, 4, 6, 3])


def ResNet50():
    return ResNet(Bottleneck, [3, 4, 6, 3])


def ResNet101():
    return ResNet(Bottleneck, [3, 4, 23, 3])


def ResNet152():
    return ResNet(Bottleneck, [3, 8, 36, 3])


def test():
    net = ResNet18()
    y = net(torch.randn(1, 3, 32, 32))
    print(y.size())

import time
import os
import sys
import shutil

TOTAL_BAR_LENGTH=65
_, term_width = shutil.get_terminal_size()
term_width = int(term_width)
last_time = time.time()
begin_time = last_time

def format_time(seconds):
    days = int(seconds / 3600/24)
    seconds = seconds - days*3600*24
    hours = int(seconds / 3600)
    seconds = seconds - hours*3600
    minutes = int(seconds / 60)
    seconds = seconds - minutes*60
    secondsf = int(seconds)
    seconds = seconds - secondsf
    millis = int(seconds*1000)

    f = ''
    i = 1
    if days > 0:
        f += str(days) + 'D'
        i += 1
    if hours > 0 and i <= 2:
        f += str(hours) + 'h'
        i += 1
    if minutes > 0 and i <= 2:
        f += str(minutes) + 'm'
        i += 1
    if secondsf > 0 and i <= 2:
        f += str(secondsf) + 's'
        i += 1
    if millis > 0 and i <= 2:
        f += str(millis) + 'ms'
        i += 1
    if f == '':
        f = '0ms'
    return f

def progress_bar(current, total, msg=None):
    global last_time, begin_time
    if current == 0:
        begin_time = time.time()  # Reset for new bar.

    cur_len = int(TOTAL_BAR_LENGTH*current/total)
    rest_len = int(TOTAL_BAR_LENGTH - cur_len) - 1

    sys.stdout.write(' [')
    for i in range(cur_len):
        sys.stdout.write('=')
    sys.stdout.write('>')
    for i in range(rest_len):
        sys.stdout.write('.')
    sys.stdout.write(']')

    cur_time = time.time()
    step_time = cur_time - last_time
    last_time = cur_time
    tot_time = cur_time - begin_time

    L = []
    L.append('  Step: %s' % format_time(step_time))
    L.append(' | Tot: %s' % format_time(tot_time))
    if msg:
        L.append(' | ' + msg)

    msg = ''.join(L)
    sys.stdout.write(msg)
    for i in range(term_width-int(TOTAL_BAR_LENGTH)-len(msg)-3):
        sys.stdout.write(' ')

    # Go back to the center of the bar.
    for i in range(term_width-int(TOTAL_BAR_LENGTH/2)+2):
        sys.stdout.write('\b')
    sys.stdout.write(' %d/%d ' % (current+1, total))

    if current < total-1:
        sys.stdout.write('\r')
    else:
        sys.stdout.write('\n')
    sys.stdout.flush()

import torch.optim as optim
import torch.backends.cudnn as cudnn

import torchvision
import torchvision.transforms as transforms

import argparse

parser = argparse.ArgumentParser(description='PyTorch CIFAR10 Training')
parser.add_argument('-f')
parser.add_argument('--lr', default=0.1, type=float, help='learning rate')
parser.add_argument('--resume', '-r', action='store_true',
                    help='resume from checkpoint')
args = parser.parse_args()

device = 'cuda' if torch.cuda.is_available() else 'cpu'
best_acc = 0  # best test accuracy
start_epoch = 0  # start from epoch 0 or last checkpoint epoch

# Data
print('==> Preparing data..')
transform_train = transforms.Compose([
    transforms.RandomCrop(32, padding=4),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(),
    transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
])

transform_test = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.4914, 0.4822, 0.4465), (0.2023, 0.1994, 0.2010)),
])

trainset = torchvision.datasets.CIFAR10(
    root='./data', train=True, download=True, transform=transform_train)
trainloader = torch.utils.data.DataLoader(
    trainset, batch_size=128, shuffle=True, num_workers=2)

testset = torchvision.datasets.CIFAR10(
    root='./data', train=False, download=True, transform=transform_test)
testloader = torch.utils.data.DataLoader(
    testset, batch_size=100, shuffle=False, num_workers=2)

classes = ('plane', 'car', 'bird', 'cat', 'deer',
           'dog', 'frog', 'horse', 'ship', 'truck')

print('==> Building model..')
net = ResNet18()

net = net.to(device)
if device == 'cuda':
    net = torch.nn.DataParallel(net)
    cudnn.benchmark = True

if args.resume:
    # Load checkpoint.
    print('==> Resuming from checkpoint..')
    assert os.path.isdir('checkpoint'), 'Error: no checkpoint directory found!'
    checkpoint = torch.load('./checkpoint/ckpt.pth')
    net.load_state_dict(checkpoint['net'])
    best_acc = checkpoint['acc']
    start_epoch = checkpoint['epoch']

criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(net.parameters(), lr=args.lr,
                      momentum=0.9, weight_decay=5e-4)
scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=200)

# Training
def train(epoch):
    print('\nEpoch: %d' % epoch)
    net.train()
    train_loss = 0
    correct = 0
    total = 0
    for batch_idx, (inputs, targets) in enumerate(trainloader):
        inputs, targets = inputs.to(device), targets.to(device)
        optimizer.zero_grad()
        outputs = net(inputs)
        loss = criterion(outputs, targets)
        loss.backward()
        optimizer.step()

        train_loss += loss.item()
        _, predicted = outputs.max(1)
        total += targets.size(0)
        correct += predicted.eq(targets).sum().item()

        progress_bar(batch_idx, len(trainloader), 'Loss: %.3f | Acc: %.3f%% (%d/%d)'
                     % (train_loss/(batch_idx+1), 100.*correct/total, correct, total))


def test(epoch):
    global best_acc
    net.eval()
    test_loss = 0
    correct = 0
    total = 0
    with torch.no_grad():
        for batch_idx, (inputs, targets) in enumerate(testloader):
            inputs, targets = inputs.to(device), targets.to(device)
            outputs = net(inputs)
            loss = criterion(outputs, targets)

            test_loss += loss.item()
            _, predicted = outputs.max(1)
            total += targets.size(0)
            correct += predicted.eq(targets).sum().item()

            progress_bar(batch_idx, len(testloader), 'Loss: %.3f | Acc: %.3f%% (%d/%d)'
                         % (test_loss/(batch_idx+1), 100.*correct/total, correct, total))

    # Save checkpoint.
    acc = 100.*correct/total
    if acc > best_acc:
        print('Saving..')
        state = {
            'net': net.state_dict(),
            'acc': acc,
            'epoch': epoch,
        }
        if not os.path.isdir('checkpoint'):
            os.mkdir('checkpoint')
        torch.save(state, './checkpoint/ckpt.pth')
        best_acc = acc


Epoch: 0
 [================================================================>]  Step: 560ms | Tot: 44s916ms | Loss: 1.870 | Acc: 32.122% (16061/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s61ms | Loss: 1.525 | Acc: 43.320% (4332/10000) 100/100 
Saving..

Epoch: 1
 [================================================================>]  Step: 73ms | Tot: 44s849ms | Loss: 1.394 | Acc: 48.714% (24357/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s104ms | Loss: 1.279 | Acc: 53.100% (5310/10000) 100/100 
Saving..

Epoch: 2
 [================================================================>]  Step: 77ms | Tot: 45s434ms | Loss: 1.131 | Acc: 59.392% (29696/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s42ms | Loss: 1.188 | Acc: 58.720% (5872/10000) 100/100 
Saving..

Epoch: 3
 [================================================================>]  Step: 72ms | Tot: 45s872ms | Loss: 0.956 | Acc: 66.132% (33066/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 3s992ms | Loss: 1.151 | Acc: 61.800% (6180/10000) 100/100 
Saving..

Epoch: 4
 [================================================================>]  Step: 71ms | Tot: 45s857ms | Loss: 0.814 | Acc: 71.424% (35712/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 3s998ms | Loss: 0.802 | Acc: 71.700% (7170/10000) 100/100 
Saving..

Epoch: 5
 [================================================================>]  Step: 78ms | Tot: 46s26ms | Loss: 0.701 | Acc: 75.734% (37867/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 3s983ms | Loss: 0.727 | Acc: 74.800% (7480/10000) 100/100 
Saving..

Epoch: 6
 [================================================================>]  Step: 76ms | Tot: 46s190ms | Loss: 0.628 | Acc: 78.186% (39093/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 3s998ms | Loss: 0.741 | Acc: 75.290% (7529/10000) 100/100 
Saving..

Epoch: 7
 [================================================================>]  Step: 71ms | Tot: 46s84ms | Loss: 0.587 | Acc: 79.668% (39834/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s63ms | Loss: 0.869 | Acc: 71.530% (7153/10000) 100/100 

Epoch: 8
 [================================================================>]  Step: 82ms | Tot: 46s179ms | Loss: 0.549 | Acc: 81.010% (40505/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 3s821ms | Loss: 0.688 | Acc: 76.660% (7666/10000) 100/100 
Saving..

Epoch: 9
 [================================================================>]  Step: 71ms | Tot: 46s84ms | Loss: 0.522 | Acc: 82.022% (41011/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s216ms | Loss: 0.926 | Acc: 71.750% (7175/10000) 100/100 

Epoch: 10
 [================================================================>]  Step: 84ms | Tot: 45s843ms | Loss: 0.501 | Acc: 82.856% (41428/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s26ms | Loss: 0.547 | Acc: 81.350% (8135/10000) 100/100 
Saving..

Epoch: 11
 [================================================================>]  Step: 79ms | Tot: 46s161ms | Loss: 0.480 | Acc: 83.480% (41740/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s32ms | Loss: 0.865 | Acc: 73.400% (7340/10000) 100/100 

Epoch: 12
 [================================================================>]  Step: 80ms | Tot: 46s124ms | Loss: 0.471 | Acc: 84.158% (42079/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s4ms | Loss: 0.702 | Acc: 77.470% (7747/10000) 100/100 

Epoch: 13
 [================================================================>]  Step: 83ms | Tot: 46s125ms | Loss: 0.452 | Acc: 84.542% (42271/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s27ms | Loss: 0.509 | Acc: 83.150% (8315/10000) 100/100 
Saving..

Epoch: 14
 [================================================================>]  Step: 69ms | Tot: 46s179ms | Loss: 0.441 | Acc: 84.840% (42420/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 3s978ms | Loss: 0.547 | Acc: 81.690% (8169/10000) 100/100 

Epoch: 15
 [================================================================>]  Step: 78ms | Tot: 45s942ms | Loss: 0.433 | Acc: 85.356% (42678/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 3s968ms | Loss: 0.605 | Acc: 79.740% (7974/10000) 100/100 

Epoch: 16
 [================================================================>]  Step: 82ms | Tot: 46s164ms | Loss: 0.419 | Acc: 85.604% (42802/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s136ms | Loss: 0.579 | Acc: 81.250% (8125/10000) 100/100 

Epoch: 17
 [================================================================>]  Step: 81ms | Tot: 45s985ms | Loss: 0.415 | Acc: 85.780% (42890/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s334ms | Loss: 0.548 | Acc: 82.260% (8226/10000) 100/100 

Epoch: 18
 [================================================================>]  Step: 81ms | Tot: 46s171ms | Loss: 0.403 | Acc: 86.488% (43244/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s301ms | Loss: 0.600 | Acc: 79.920% (7992/10000) 100/100 

Epoch: 19
 [================================================================>]  Step: 76ms | Tot: 45s995ms | Loss: 0.400 | Acc: 86.340% (43170/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s83ms | Loss: 0.536 | Acc: 82.450% (8245/10000) 100/100 

Epoch: 20
 [================================================================>]  Step: 78ms | Tot: 45s763ms | Loss: 0.391 | Acc: 86.708% (43354/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 3s984ms | Loss: 0.600 | Acc: 80.970% (8097/10000) 100/100 

Epoch: 21
 [================================================================>]  Step: 84ms | Tot: 45s938ms | Loss: 0.384 | Acc: 86.772% (43386/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 3s893ms | Loss: 0.501 | Acc: 83.390% (8339/10000) 100/100 
Saving..

Epoch: 22
 [================================================================>]  Step: 82ms | Tot: 45s691ms | Loss: 0.380 | Acc: 86.980% (43490/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 3s869ms | Loss: 0.452 | Acc: 84.860% (8486/10000) 100/100 
Saving..

Epoch: 23
 [================================================================>]  Step: 73ms | Tot: 45s920ms | Loss: 0.382 | Acc: 86.900% (43450/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s126ms | Loss: 0.622 | Acc: 79.990% (7999/10000) 100/100 

Epoch: 24
 [================================================================>]  Step: 77ms | Tot: 45s887ms | Loss: 0.367 | Acc: 87.384% (43692/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 3s971ms | Loss: 0.464 | Acc: 84.560% (8456/10000) 100/100 

Epoch: 25
 [================================================================>]  Step: 75ms | Tot: 45s909ms | Loss: 0.359 | Acc: 87.684% (43842/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s132ms | Loss: 0.483 | Acc: 83.830% (8383/10000) 100/100 

Epoch: 26
 [================================================================>]  Step: 78ms | Tot: 45s961ms | Loss: 0.365 | Acc: 87.652% (43826/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s55ms | Loss: 0.537 | Acc: 82.460% (8246/10000) 100/100 

Epoch: 27
 [================================================================>]  Step: 79ms | Tot: 45s852ms | Loss: 0.361 | Acc: 87.664% (43832/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 3s988ms | Loss: 0.517 | Acc: 83.310% (8331/10000) 100/100 

Epoch: 28
 [================================================================>]  Step: 83ms | Tot: 46s72ms | Loss: 0.352 | Acc: 88.076% (44038/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 4s11ms | Loss: 0.582 | Acc: 80.710% (8071/10000) 100/100 

Epoch: 29
 [================================================================>]  Step: 74ms | Tot: 45s836ms | Loss: 0.355 | Acc: 88.012% (44006/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 3s876ms | Loss: 0.470 | Acc: 84.170% (8417/10000) 100/100 

Epoch: 30
 [================================================================>]  Step: 82ms | Tot: 45s750ms | Loss: 0.344 | Acc: 88.186% (44093/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s25ms | Loss: 0.432 | Acc: 85.450% (8545/10000) 100/100 
Saving..

Epoch: 31
 [================================================================>]  Step: 76ms | Tot: 45s833ms | Loss: 0.350 | Acc: 88.052% (44026/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 3s998ms | Loss: 0.828 | Acc: 75.140% (7514/10000) 100/100 

Epoch: 32
 [================================================================>]  Step: 83ms | Tot: 45s691ms | Loss: 0.339 | Acc: 88.472% (44236/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 3s941ms | Loss: 0.444 | Acc: 85.260% (8526/10000) 100/100 

Epoch: 33
 [================================================================>]  Step: 75ms | Tot: 45s621ms | Loss: 0.338 | Acc: 88.476% (44238/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 3s896ms | Loss: 0.500 | Acc: 83.940% (8394/10000) 100/100 

Epoch: 34
 [================================================================>]  Step: 84ms | Tot: 45s844ms | Loss: 0.336 | Acc: 88.532% (44266/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s119ms | Loss: 0.426 | Acc: 85.720% (8572/10000) 100/100 
Saving..

Epoch: 35
 [================================================================>]  Step: 83ms | Tot: 46s313ms | Loss: 0.336 | Acc: 88.590% (44295/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s75ms | Loss: 0.710 | Acc: 78.800% (7880/10000) 100/100 

Epoch: 36
 [================================================================>]  Step: 80ms | Tot: 45s753ms | Loss: 0.338 | Acc: 88.428% (44214/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s24ms | Loss: 0.469 | Acc: 84.470% (8447/10000) 100/100 

Epoch: 37
 [================================================================>]  Step: 84ms | Tot: 46s20ms | Loss: 0.318 | Acc: 89.054% (44527/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 3s972ms | Loss: 0.507 | Acc: 82.820% (8282/10000) 100/100 

Epoch: 38
 [================================================================>]  Step: 79ms | Tot: 45s661ms | Loss: 0.326 | Acc: 88.896% (44448/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s111ms | Loss: 0.426 | Acc: 85.740% (8574/10000) 100/100 
Saving..

Epoch: 39
 [================================================================>]  Step: 82ms | Tot: 45s920ms | Loss: 0.327 | Acc: 88.890% (44445/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s84ms | Loss: 0.528 | Acc: 82.930% (8293/10000) 100/100 

Epoch: 40
 [================================================================>]  Step: 83ms | Tot: 46s142ms | Loss: 0.320 | Acc: 89.084% (44542/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 3s860ms | Loss: 0.553 | Acc: 82.430% (8243/10000) 100/100 

Epoch: 41
 [================================================================>]  Step: 81ms | Tot: 45s961ms | Loss: 0.321 | Acc: 89.146% (44573/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s12ms | Loss: 0.459 | Acc: 85.220% (8522/10000) 100/100 

Epoch: 42
 [================================================================>]  Step: 76ms | Tot: 46s293ms | Loss: 0.319 | Acc: 89.196% (44598/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 3s915ms | Loss: 0.536 | Acc: 82.830% (8283/10000) 100/100 

Epoch: 43
 [================================================================>]  Step: 82ms | Tot: 45s827ms | Loss: 0.315 | Acc: 89.358% (44679/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s100ms | Loss: 0.496 | Acc: 83.970% (8397/10000) 100/100 

Epoch: 44
 [================================================================>]  Step: 75ms | Tot: 46s113ms | Loss: 0.315 | Acc: 89.378% (44689/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s138ms | Loss: 0.480 | Acc: 84.250% (8425/10000) 100/100 

Epoch: 45
 [================================================================>]  Step: 79ms | Tot: 45s822ms | Loss: 0.311 | Acc: 89.412% (44706/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s130ms | Loss: 0.420 | Acc: 85.790% (8579/10000) 100/100 
Saving..

Epoch: 46
 [================================================================>]  Step: 71ms | Tot: 45s854ms | Loss: 0.312 | Acc: 89.466% (44733/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s129ms | Loss: 0.435 | Acc: 85.430% (8543/10000) 100/100 

Epoch: 47
 [================================================================>]  Step: 73ms | Tot: 46s19ms | Loss: 0.308 | Acc: 89.468% (44734/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s4ms | Loss: 0.421 | Acc: 85.620% (8562/10000) 100/100 

Epoch: 48
 [================================================================>]  Step: 80ms | Tot: 46s128ms | Loss: 0.307 | Acc: 89.714% (44857/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 3s962ms | Loss: 0.550 | Acc: 82.730% (8273/10000) 100/100 

Epoch: 49
 [================================================================>]  Step: 75ms | Tot: 45s682ms | Loss: 0.305 | Acc: 89.654% (44827/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s162ms | Loss: 0.491 | Acc: 83.780% (8378/10000) 100/100 

Epoch: 50
 [================================================================>]  Step: 83ms | Tot: 45s903ms | Loss: 0.304 | Acc: 89.680% (44840/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s143ms | Loss: 0.453 | Acc: 84.980% (8498/10000) 100/100 

Epoch: 51
 [================================================================>]  Step: 76ms | Tot: 46s62ms | Loss: 0.298 | Acc: 89.946% (44973/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s34ms | Loss: 0.478 | Acc: 84.900% (8490/10000) 100/100 

Epoch: 52
 [================================================================>]  Step: 82ms | Tot: 45s777ms | Loss: 0.304 | Acc: 89.526% (44763/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s158ms | Loss: 0.426 | Acc: 86.130% (8613/10000) 100/100 
Saving..

Epoch: 53
 [================================================================>]  Step: 74ms | Tot: 46s11ms | Loss: 0.292 | Acc: 90.074% (45037/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s34ms | Loss: 0.579 | Acc: 81.770% (8177/10000) 100/100 

Epoch: 54
 [================================================================>]  Step: 73ms | Tot: 45s928ms | Loss: 0.291 | Acc: 90.040% (45020/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 3s921ms | Loss: 0.551 | Acc: 82.660% (8266/10000) 100/100 

Epoch: 55
 [================================================================>]  Step: 68ms | Tot: 45s932ms | Loss: 0.291 | Acc: 90.114% (45057/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 3s920ms | Loss: 0.656 | Acc: 79.030% (7903/10000) 100/100 

Epoch: 56
 [================================================================>]  Step: 82ms | Tot: 45s944ms | Loss: 0.290 | Acc: 90.150% (45075/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s168ms | Loss: 0.591 | Acc: 81.530% (8153/10000) 100/100 

Epoch: 57
 [================================================================>]  Step: 81ms | Tot: 45s727ms | Loss: 0.286 | Acc: 90.278% (45139/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 3s918ms | Loss: 0.526 | Acc: 83.080% (8308/10000) 100/100 

Epoch: 58
 [================================================================>]  Step: 82ms | Tot: 45s915ms | Loss: 0.288 | Acc: 90.226% (45113/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s92ms | Loss: 0.447 | Acc: 85.490% (8549/10000) 100/100 

Epoch: 59
 [================================================================>]  Step: 82ms | Tot: 45s691ms | Loss: 0.285 | Acc: 90.256% (45128/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 3s999ms | Loss: 0.486 | Acc: 84.880% (8488/10000) 100/100 

Epoch: 60
 [================================================================>]  Step: 75ms | Tot: 46s94ms | Loss: 0.282 | Acc: 90.364% (45182/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s16ms | Loss: 0.466 | Acc: 85.030% (8503/10000) 100/100 

Epoch: 61
 [================================================================>]  Step: 81ms | Tot: 46s88ms | Loss: 0.281 | Acc: 90.524% (45262/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 3s967ms | Loss: 0.414 | Acc: 86.490% (8649/10000) 100/100 
Saving..

Epoch: 62
 [================================================================>]  Step: 79ms | Tot: 45s943ms | Loss: 0.275 | Acc: 90.616% (45308/50000) 391/391 
 [================================================================>]  Step: 52ms | Tot: 3s880ms | Loss: 0.505 | Acc: 84.260% (8426/10000) 100/100 

Epoch: 63
 [================================================================>]  Step: 77ms | Tot: 46s161ms | Loss: 0.271 | Acc: 90.808% (45404/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 3s968ms | Loss: 0.392 | Acc: 86.880% (8688/10000) 100/100 
Saving..

Epoch: 64
 [================================================================>]  Step: 75ms | Tot: 45s814ms | Loss: 0.272 | Acc: 90.766% (45383/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 3s999ms | Loss: 0.379 | Acc: 87.680% (8768/10000) 100/100 
Saving..

Epoch: 65
 [================================================================>]  Step: 73ms | Tot: 45s903ms | Loss: 0.273 | Acc: 90.672% (45336/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 3s997ms | Loss: 0.457 | Acc: 85.610% (8561/10000) 100/100 

Epoch: 66
 [================================================================>]  Step: 72ms | Tot: 45s742ms | Loss: 0.270 | Acc: 90.734% (45367/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s170ms | Loss: 0.447 | Acc: 85.190% (8519/10000) 100/100 

Epoch: 67
 [================================================================>]  Step: 76ms | Tot: 46s6ms | Loss: 0.273 | Acc: 90.664% (45332/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s15ms | Loss: 0.398 | Acc: 86.950% (8695/10000) 100/100 

Epoch: 68
 [================================================================>]  Step: 70ms | Tot: 45s966ms | Loss: 0.265 | Acc: 91.020% (45510/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s6ms | Loss: 0.396 | Acc: 87.150% (8715/10000) 100/100 

Epoch: 69
 [================================================================>]  Step: 78ms | Tot: 46s122ms | Loss: 0.257 | Acc: 91.210% (45605/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s20ms | Loss: 0.436 | Acc: 86.080% (8608/10000) 100/100 

Epoch: 70
 [================================================================>]  Step: 79ms | Tot: 45s950ms | Loss: 0.257 | Acc: 91.162% (45581/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s208ms | Loss: 0.442 | Acc: 85.970% (8597/10000) 100/100 

Epoch: 71
 [================================================================>]  Step: 78ms | Tot: 45s950ms | Loss: 0.261 | Acc: 91.030% (45515/50000) 391/391 
 [================================================================>]  Step: 53ms | Tot: 4s72ms | Loss: 0.416 | Acc: 86.500% (8650/10000) 100/100 

Epoch: 72
 [================================================================>]  Step: 74ms | Tot: 45s973ms | Loss: 0.265 | Acc: 90.926% (45463/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s221ms | Loss: 0.505 | Acc: 83.800% (8380/10000) 100/100 

Epoch: 73
 [================================================================>]  Step: 79ms | Tot: 45s930ms | Loss: 0.252 | Acc: 91.362% (45681/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 3s855ms | Loss: 0.452 | Acc: 85.360% (8536/10000) 100/100 

Epoch: 74
 [================================================================>]  Step: 81ms | Tot: 45s516ms | Loss: 0.254 | Acc: 91.248% (45624/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 3s883ms | Loss: 0.413 | Acc: 86.760% (8676/10000) 100/100 

Epoch: 75
 [================================================================>]  Step: 82ms | Tot: 45s895ms | Loss: 0.250 | Acc: 91.458% (45729/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s102ms | Loss: 0.349 | Acc: 88.610% (8861/10000) 100/100 
Saving..

Epoch: 76
 [================================================================>]  Step: 86ms | Tot: 45s985ms | Loss: 0.240 | Acc: 91.780% (45890/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s54ms | Loss: 0.522 | Acc: 83.980% (8398/10000) 100/100 

Epoch: 77
 [================================================================>]  Step: 74ms | Tot: 45s779ms | Loss: 0.242 | Acc: 91.786% (45893/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 3s945ms | Loss: 0.329 | Acc: 89.080% (8908/10000) 100/100 
Saving..

Epoch: 78
 [================================================================>]  Step: 80ms | Tot: 45s762ms | Loss: 0.237 | Acc: 91.824% (45912/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s222ms | Loss: 0.354 | Acc: 88.080% (8808/10000) 100/100 

Epoch: 79
 [================================================================>]  Step: 76ms | Tot: 45s834ms | Loss: 0.243 | Acc: 91.670% (45835/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s7ms | Loss: 0.394 | Acc: 87.270% (8727/10000) 100/100 

Epoch: 80
 [================================================================>]  Step: 78ms | Tot: 45s814ms | Loss: 0.237 | Acc: 91.880% (45940/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s153ms | Loss: 0.326 | Acc: 89.600% (8960/10000) 100/100 
Saving..

Epoch: 81
 [================================================================>]  Step: 76ms | Tot: 46s232ms | Loss: 0.239 | Acc: 91.744% (45872/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 3s981ms | Loss: 0.409 | Acc: 86.940% (8694/10000) 100/100 

Epoch: 82
 [================================================================>]  Step: 73ms | Tot: 46s3ms | Loss: 0.235 | Acc: 91.904% (45952/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s153ms | Loss: 0.347 | Acc: 88.480% (8848/10000) 100/100 

Epoch: 83
 [================================================================>]  Step: 84ms | Tot: 45s789ms | Loss: 0.232 | Acc: 92.074% (46037/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 3s920ms | Loss: 0.493 | Acc: 84.410% (8441/10000) 100/100 

Epoch: 84
 [================================================================>]  Step: 85ms | Tot: 46s46ms | Loss: 0.224 | Acc: 92.268% (46134/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 3s996ms | Loss: 0.359 | Acc: 88.050% (8805/10000) 100/100 

Epoch: 85
 [================================================================>]  Step: 88ms | Tot: 46s109ms | Loss: 0.226 | Acc: 92.298% (46149/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s133ms | Loss: 0.405 | Acc: 87.290% (8729/10000) 100/100 

Epoch: 86
 [================================================================>]  Step: 72ms | Tot: 45s874ms | Loss: 0.224 | Acc: 92.500% (46250/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s138ms | Loss: 0.345 | Acc: 89.180% (8918/10000) 100/100 

Epoch: 87
 [================================================================>]  Step: 86ms | Tot: 46s201ms | Loss: 0.220 | Acc: 92.378% (46189/50000) 391/391 
 [================================================================>]  Step: 52ms | Tot: 4s16ms | Loss: 0.380 | Acc: 87.710% (8771/10000) 100/100 

Epoch: 88
 [================================================================>]  Step: 69ms | Tot: 45s814ms | Loss: 0.221 | Acc: 92.386% (46193/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s32ms | Loss: 0.408 | Acc: 87.110% (8711/10000) 100/100 

Epoch: 89
 [================================================================>]  Step: 75ms | Tot: 45s915ms | Loss: 0.214 | Acc: 92.724% (46362/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s87ms | Loss: 0.393 | Acc: 87.580% (8758/10000) 100/100 

Epoch: 90
 [================================================================>]  Step: 74ms | Tot: 45s644ms | Loss: 0.216 | Acc: 92.756% (46378/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 3s973ms | Loss: 0.376 | Acc: 88.200% (8820/10000) 100/100 

Epoch: 91
 [================================================================>]  Step: 81ms | Tot: 45s897ms | Loss: 0.217 | Acc: 92.566% (46283/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s124ms | Loss: 0.446 | Acc: 86.000% (8600/10000) 100/100 

Epoch: 92
 [================================================================>]  Step: 74ms | Tot: 45s874ms | Loss: 0.207 | Acc: 93.028% (46514/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s187ms | Loss: 0.374 | Acc: 87.800% (8780/10000) 100/100 

Epoch: 93
 [================================================================>]  Step: 71ms | Tot: 45s904ms | Loss: 0.205 | Acc: 93.042% (46521/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s106ms | Loss: 0.401 | Acc: 87.450% (8745/10000) 100/100 

Epoch: 94
 [================================================================>]  Step: 81ms | Tot: 45s947ms | Loss: 0.206 | Acc: 93.004% (46502/50000) 391/391 
 [================================================================>]  Step: 29ms | Tot: 4s93ms | Loss: 0.359 | Acc: 88.440% (8844/10000) 100/100 

Epoch: 95
 [================================================================>]  Step: 80ms | Tot: 46s395ms | Loss: 0.199 | Acc: 93.176% (46588/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s133ms | Loss: 0.410 | Acc: 87.270% (8727/10000) 100/100 

Epoch: 96
 [================================================================>]  Step: 79ms | Tot: 46s98ms | Loss: 0.197 | Acc: 93.190% (46595/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s71ms | Loss: 0.397 | Acc: 87.600% (8760/10000) 100/100 

Epoch: 97
 [================================================================>]  Step: 74ms | Tot: 46s144ms | Loss: 0.194 | Acc: 93.414% (46707/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s151ms | Loss: 0.462 | Acc: 85.700% (8570/10000) 100/100 

Epoch: 98
 [================================================================>]  Step: 82ms | Tot: 46s155ms | Loss: 0.197 | Acc: 93.304% (46652/50000) 391/391 
 [================================================================>]  Step: 26ms | Tot: 4s103ms | Loss: 0.330 | Acc: 89.610% (8961/10000) 100/100 
Saving..

Epoch: 99
 [================================================================>]  Step: 67ms | Tot: 46s327ms | Loss: 0.189 | Acc: 93.578% (46789/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s122ms | Loss: 0.325 | Acc: 89.470% (8947/10000) 100/100 

Epoch: 100
 [================================================================>]  Step: 78ms | Tot: 46s196ms | Loss: 0.187 | Acc: 93.618% (46809/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s169ms | Loss: 0.325 | Acc: 89.550% (8955/10000) 100/100 

Epoch: 101
 [================================================================>]  Step: 81ms | Tot: 46s6ms | Loss: 0.187 | Acc: 93.550% (46775/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s196ms | Loss: 0.377 | Acc: 87.760% (8776/10000) 100/100 

Epoch: 102
 [================================================================>]  Step: 79ms | Tot: 46s61ms | Loss: 0.178 | Acc: 93.968% (46984/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s13ms | Loss: 0.331 | Acc: 89.610% (8961/10000) 100/100 

Epoch: 103
 [================================================================>]  Step: 78ms | Tot: 46s92ms | Loss: 0.186 | Acc: 93.648% (46824/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s101ms | Loss: 0.318 | Acc: 89.770% (8977/10000) 100/100 
Saving..

Epoch: 104
 [================================================================>]  Step: 71ms | Tot: 46s73ms | Loss: 0.179 | Acc: 94.000% (47000/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s201ms | Loss: 0.309 | Acc: 89.950% (8995/10000) 100/100 
Saving..

Epoch: 105
 [================================================================>]  Step: 75ms | Tot: 45s839ms | Loss: 0.177 | Acc: 93.940% (46970/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s230ms | Loss: 0.346 | Acc: 88.900% (8890/10000) 100/100 

Epoch: 106
 [================================================================>]  Step: 82ms | Tot: 46s156ms | Loss: 0.172 | Acc: 94.036% (47018/50000) 391/391 
 [================================================================>]  Step: 24ms | Tot: 4s121ms | Loss: 0.322 | Acc: 89.930% (8993/10000) 100/100 

Epoch: 107
 [================================================================>]  Step: 82ms | Tot: 46s193ms | Loss: 0.168 | Acc: 94.308% (47154/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s60ms | Loss: 0.330 | Acc: 88.940% (8894/10000) 100/100 

Epoch: 108
 [================================================================>]  Step: 81ms | Tot: 45s704ms | Loss: 0.167 | Acc: 94.246% (47123/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s240ms | Loss: 0.373 | Acc: 88.140% (8814/10000) 100/100 

Epoch: 109
 [================================================================>]  Step: 79ms | Tot: 46s336ms | Loss: 0.166 | Acc: 94.316% (47158/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s162ms | Loss: 0.338 | Acc: 89.300% (8930/10000) 100/100 

Epoch: 110
 [================================================================>]  Step: 81ms | Tot: 45s866ms | Loss: 0.156 | Acc: 94.622% (47311/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s92ms | Loss: 0.363 | Acc: 88.850% (8885/10000) 100/100 

Epoch: 111
 [================================================================>]  Step: 69ms | Tot: 45s998ms | Loss: 0.155 | Acc: 94.716% (47358/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s38ms | Loss: 0.368 | Acc: 88.480% (8848/10000) 100/100 

Epoch: 112
 [================================================================>]  Step: 78ms | Tot: 45s827ms | Loss: 0.154 | Acc: 94.746% (47373/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 3s931ms | Loss: 0.371 | Acc: 88.320% (8832/10000) 100/100 

Epoch: 113
 [================================================================>]  Step: 83ms | Tot: 46s124ms | Loss: 0.151 | Acc: 94.834% (47417/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s8ms | Loss: 0.346 | Acc: 89.200% (8920/10000) 100/100 

Epoch: 114
 [================================================================>]  Step: 77ms | Tot: 45s718ms | Loss: 0.148 | Acc: 94.950% (47475/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s187ms | Loss: 0.442 | Acc: 87.430% (8743/10000) 100/100 

Epoch: 115
 [================================================================>]  Step: 78ms | Tot: 45s773ms | Loss: 0.149 | Acc: 94.880% (47440/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s12ms | Loss: 0.313 | Acc: 90.350% (9035/10000) 100/100 
Saving..

Epoch: 116
 [================================================================>]  Step: 76ms | Tot: 45s948ms | Loss: 0.146 | Acc: 95.054% (47527/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s48ms | Loss: 0.296 | Acc: 90.700% (9070/10000) 100/100 
Saving..

Epoch: 117
 [================================================================>]  Step: 78ms | Tot: 46s160ms | Loss: 0.136 | Acc: 95.314% (47657/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 3s993ms | Loss: 0.339 | Acc: 89.420% (8942/10000) 100/100 

Epoch: 118
 [================================================================>]  Step: 86ms | Tot: 46s99ms | Loss: 0.138 | Acc: 95.282% (47641/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s252ms | Loss: 0.320 | Acc: 89.840% (8984/10000) 100/100 

Epoch: 119
 [================================================================>]  Step: 87ms | Tot: 46s109ms | Loss: 0.133 | Acc: 95.474% (47737/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s21ms | Loss: 0.291 | Acc: 90.520% (9052/10000) 100/100 

Epoch: 120
 [================================================================>]  Step: 74ms | Tot: 46s107ms | Loss: 0.134 | Acc: 95.336% (47668/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s226ms | Loss: 0.309 | Acc: 90.360% (9036/10000) 100/100 

Epoch: 121
 [================================================================>]  Step: 67ms | Tot: 46s234ms | Loss: 0.125 | Acc: 95.808% (47904/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s255ms | Loss: 0.286 | Acc: 90.850% (9085/10000) 100/100 
Saving..

Epoch: 122
 [================================================================>]  Step: 86ms | Tot: 46s25ms | Loss: 0.131 | Acc: 95.482% (47741/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s182ms | Loss: 0.314 | Acc: 90.100% (9010/10000) 100/100 

Epoch: 123
 [================================================================>]  Step: 82ms | Tot: 46s61ms | Loss: 0.122 | Acc: 95.762% (47881/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s256ms | Loss: 0.336 | Acc: 89.820% (8982/10000) 100/100 

Epoch: 124
 [================================================================>]  Step: 84ms | Tot: 46s84ms | Loss: 0.119 | Acc: 95.872% (47936/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s175ms | Loss: 0.304 | Acc: 91.040% (9104/10000) 100/100 
Saving..

Epoch: 125
 [================================================================>]  Step: 83ms | Tot: 46s627ms | Loss: 0.116 | Acc: 96.106% (48053/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s257ms | Loss: 0.290 | Acc: 91.190% (9119/10000) 100/100 
Saving..

Epoch: 126
 [================================================================>]  Step: 78ms | Tot: 45s842ms | Loss: 0.112 | Acc: 96.198% (48099/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s140ms | Loss: 0.290 | Acc: 91.080% (9108/10000) 100/100 

Epoch: 127
 [================================================================>]  Step: 91ms | Tot: 46s489ms | Loss: 0.112 | Acc: 96.156% (48078/50000) 391/391 
 [================================================================>]  Step: 56ms | Tot: 4s254ms | Loss: 0.294 | Acc: 90.790% (9079/10000) 100/100 

Epoch: 128
 [================================================================>]  Step: 84ms | Tot: 46s291ms | Loss: 0.116 | Acc: 96.056% (48028/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s259ms | Loss: 0.373 | Acc: 88.600% (8860/10000) 100/100 

Epoch: 129
 [================================================================>]  Step: 75ms | Tot: 45s868ms | Loss: 0.105 | Acc: 96.396% (48198/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s47ms | Loss: 0.309 | Acc: 90.720% (9072/10000) 100/100 

Epoch: 130
 [================================================================>]  Step: 74ms | Tot: 46s265ms | Loss: 0.101 | Acc: 96.568% (48284/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s135ms | Loss: 0.293 | Acc: 91.270% (9127/10000) 100/100 
Saving..

Epoch: 131
 [================================================================>]  Step: 82ms | Tot: 45s992ms | Loss: 0.096 | Acc: 96.794% (48397/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s383ms | Loss: 0.282 | Acc: 91.510% (9151/10000) 100/100 
Saving..

Epoch: 132
 [================================================================>]  Step: 84ms | Tot: 46s73ms | Loss: 0.098 | Acc: 96.750% (48375/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s215ms | Loss: 0.313 | Acc: 90.870% (9087/10000) 100/100 

Epoch: 133
 [================================================================>]  Step: 73ms | Tot: 46s430ms | Loss: 0.095 | Acc: 96.712% (48356/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s93ms | Loss: 0.304 | Acc: 90.790% (9079/10000) 100/100 

Epoch: 134
 [================================================================>]  Step: 87ms | Tot: 45s819ms | Loss: 0.088 | Acc: 97.084% (48542/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s163ms | Loss: 0.276 | Acc: 91.740% (9174/10000) 100/100 
Saving..

Epoch: 135
 [================================================================>]  Step: 70ms | Tot: 46s82ms | Loss: 0.088 | Acc: 97.060% (48530/50000) 391/391 
 [================================================================>]  Step: 52ms | Tot: 4s298ms | Loss: 0.313 | Acc: 90.960% (9096/10000) 100/100 

Epoch: 136
 [================================================================>]  Step: 82ms | Tot: 46s299ms | Loss: 0.084 | Acc: 97.146% (48573/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s217ms | Loss: 0.293 | Acc: 91.100% (9110/10000) 100/100 

Epoch: 137
 [================================================================>]  Step: 81ms | Tot: 46s275ms | Loss: 0.086 | Acc: 97.068% (48534/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s253ms | Loss: 0.273 | Acc: 91.940% (9194/10000) 100/100 
Saving..

Epoch: 138
 [================================================================>]  Step: 88ms | Tot: 46s262ms | Loss: 0.072 | Acc: 97.610% (48805/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s181ms | Loss: 0.273 | Acc: 92.050% (9205/10000) 100/100 
Saving..

Epoch: 139
 [================================================================>]  Step: 81ms | Tot: 46s124ms | Loss: 0.073 | Acc: 97.510% (48755/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s187ms | Loss: 0.269 | Acc: 91.580% (9158/10000) 100/100 

Epoch: 140
 [================================================================>]  Step: 85ms | Tot: 46s702ms | Loss: 0.073 | Acc: 97.518% (48759/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s626ms | Loss: 0.289 | Acc: 91.350% (9135/10000) 100/100 

Epoch: 141
 [================================================================>]  Step: 72ms | Tot: 46s314ms | Loss: 0.066 | Acc: 97.774% (48887/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s209ms | Loss: 0.295 | Acc: 91.380% (9138/10000) 100/100 

Epoch: 142
 [================================================================>]  Step: 70ms | Tot: 45s905ms | Loss: 0.068 | Acc: 97.694% (48847/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s125ms | Loss: 0.271 | Acc: 92.050% (9205/10000) 100/100 

Epoch: 143
 [================================================================>]  Step: 84ms | Tot: 45s996ms | Loss: 0.062 | Acc: 97.938% (48969/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s206ms | Loss: 0.270 | Acc: 92.290% (9229/10000) 100/100 
Saving..

Epoch: 144
 [================================================================>]  Step: 74ms | Tot: 46s13ms | Loss: 0.063 | Acc: 97.968% (48984/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s212ms | Loss: 0.235 | Acc: 93.010% (9301/10000) 100/100 
Saving..

Epoch: 145
 [================================================================>]  Step: 72ms | Tot: 46s95ms | Loss: 0.054 | Acc: 98.206% (49103/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s223ms | Loss: 0.339 | Acc: 90.960% (9096/10000) 100/100 

Epoch: 146
 [================================================================>]  Step: 83ms | Tot: 46s17ms | Loss: 0.057 | Acc: 98.116% (49058/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s111ms | Loss: 0.239 | Acc: 93.120% (9312/10000) 100/100 
Saving..

Epoch: 147
 [================================================================>]  Step: 72ms | Tot: 46s108ms | Loss: 0.058 | Acc: 98.056% (49028/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s187ms | Loss: 0.261 | Acc: 92.370% (9237/10000) 100/100 

Epoch: 148
 [================================================================>]  Step: 80ms | Tot: 46s333ms | Loss: 0.051 | Acc: 98.358% (49179/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s194ms | Loss: 0.247 | Acc: 92.730% (9273/10000) 100/100 

Epoch: 149
 [================================================================>]  Step: 73ms | Tot: 46s105ms | Loss: 0.044 | Acc: 98.568% (49284/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s288ms | Loss: 0.288 | Acc: 92.080% (9208/10000) 100/100 

Epoch: 150
 [================================================================>]  Step: 76ms | Tot: 46s83ms | Loss: 0.043 | Acc: 98.556% (49278/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s257ms | Loss: 0.239 | Acc: 93.310% (9331/10000) 100/100 
Saving..

Epoch: 151
 [================================================================>]  Step: 81ms | Tot: 46s306ms | Loss: 0.042 | Acc: 98.598% (49299/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s158ms | Loss: 0.261 | Acc: 92.530% (9253/10000) 100/100 

Epoch: 152
 [================================================================>]  Step: 82ms | Tot: 46s432ms | Loss: 0.037 | Acc: 98.838% (49419/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s234ms | Loss: 0.269 | Acc: 92.670% (9267/10000) 100/100 

Epoch: 153
 [================================================================>]  Step: 81ms | Tot: 46s487ms | Loss: 0.033 | Acc: 98.920% (49460/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s341ms | Loss: 0.272 | Acc: 92.960% (9296/10000) 100/100 

Epoch: 154
 [================================================================>]  Step: 87ms | Tot: 46s317ms | Loss: 0.032 | Acc: 98.998% (49499/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s390ms | Loss: 0.264 | Acc: 92.770% (9277/10000) 100/100 

Epoch: 155
 [================================================================>]  Step: 82ms | Tot: 46s86ms | Loss: 0.033 | Acc: 98.888% (49444/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s208ms | Loss: 0.246 | Acc: 93.280% (9328/10000) 100/100 

Epoch: 156
 [================================================================>]  Step: 69ms | Tot: 46s209ms | Loss: 0.028 | Acc: 99.108% (49554/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s188ms | Loss: 0.219 | Acc: 94.120% (9412/10000) 100/100 
Saving..

Epoch: 157
 [================================================================>]  Step: 85ms | Tot: 46s247ms | Loss: 0.026 | Acc: 99.144% (49572/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s195ms | Loss: 0.237 | Acc: 93.840% (9384/10000) 100/100 

Epoch: 158
 [================================================================>]  Step: 74ms | Tot: 46s251ms | Loss: 0.022 | Acc: 99.336% (49668/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s143ms | Loss: 0.223 | Acc: 94.160% (9416/10000) 100/100 
Saving..

Epoch: 159
 [================================================================>]  Step: 81ms | Tot: 46s210ms | Loss: 0.017 | Acc: 99.498% (49749/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s362ms | Loss: 0.220 | Acc: 94.200% (9420/10000) 100/100 
Saving..

Epoch: 160
 [================================================================>]  Step: 83ms | Tot: 46s161ms | Loss: 0.018 | Acc: 99.458% (49729/50000) 391/391 
 [================================================================>]  Step: 51ms | Tot: 4s230ms | Loss: 0.219 | Acc: 94.290% (9429/10000) 100/100 
Saving..

Epoch: 161
 [================================================================>]  Step: 82ms | Tot: 46s20ms | Loss: 0.019 | Acc: 99.400% (49700/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s185ms | Loss: 0.259 | Acc: 93.390% (9339/10000) 100/100 

Epoch: 162
 [================================================================>]  Step: 78ms | Tot: 46s431ms | Loss: 0.018 | Acc: 99.470% (49735/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s539ms | Loss: 0.241 | Acc: 93.620% (9362/10000) 100/100 

Epoch: 163
 [================================================================>]  Step: 70ms | Tot: 46s230ms | Loss: 0.013 | Acc: 99.646% (49823/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s312ms | Loss: 0.219 | Acc: 94.290% (9429/10000) 100/100 

Epoch: 164
 [================================================================>]  Step: 72ms | Tot: 46s149ms | Loss: 0.011 | Acc: 99.720% (49860/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s170ms | Loss: 0.216 | Acc: 94.300% (9430/10000) 100/100 
Saving..

Epoch: 165
 [================================================================>]  Step: 81ms | Tot: 46s318ms | Loss: 0.009 | Acc: 99.786% (49893/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s96ms | Loss: 0.204 | Acc: 94.660% (9466/10000) 100/100 
Saving..

Epoch: 166
 [================================================================>]  Step: 81ms | Tot: 46s253ms | Loss: 0.008 | Acc: 99.804% (49902/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s246ms | Loss: 0.209 | Acc: 94.630% (9463/10000) 100/100 

Epoch: 167
 [================================================================>]  Step: 80ms | Tot: 45s804ms | Loss: 0.007 | Acc: 99.852% (49926/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s238ms | Loss: 0.207 | Acc: 94.640% (9464/10000) 100/100 

Epoch: 168
 [================================================================>]  Step: 82ms | Tot: 46s224ms | Loss: 0.005 | Acc: 99.910% (49955/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s472ms | Loss: 0.198 | Acc: 94.840% (9484/10000) 100/100 
Saving..

Epoch: 169
 [================================================================>]  Step: 87ms | Tot: 46s170ms | Loss: 0.004 | Acc: 99.914% (49957/50000) 391/391 
 [================================================================>]  Step: 52ms | Tot: 4s364ms | Loss: 0.199 | Acc: 94.880% (9488/10000) 100/100 
Saving..

Epoch: 170
 [================================================================>]  Step: 83ms | Tot: 46s158ms | Loss: 0.004 | Acc: 99.920% (49960/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s152ms | Loss: 0.194 | Acc: 95.100% (9510/10000) 100/100 
Saving..

Epoch: 171
 [================================================================>]  Step: 83ms | Tot: 46s392ms | Loss: 0.004 | Acc: 99.950% (49975/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s340ms | Loss: 0.189 | Acc: 94.940% (9494/10000) 100/100 

Epoch: 172
 [================================================================>]  Step: 77ms | Tot: 46s312ms | Loss: 0.003 | Acc: 99.962% (49981/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s253ms | Loss: 0.182 | Acc: 95.290% (9529/10000) 100/100 
Saving..

Epoch: 173
 [================================================================>]  Step: 73ms | Tot: 46s591ms | Loss: 0.003 | Acc: 99.954% (49977/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s234ms | Loss: 0.186 | Acc: 95.270% (9527/10000) 100/100 

Epoch: 174
 [================================================================>]  Step: 83ms | Tot: 46s285ms | Loss: 0.002 | Acc: 99.976% (49988/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s365ms | Loss: 0.181 | Acc: 95.380% (9538/10000) 100/100 
Saving..

Epoch: 175
 [================================================================>]  Step: 72ms | Tot: 45s924ms | Loss: 0.002 | Acc: 99.984% (49992/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s75ms | Loss: 0.187 | Acc: 95.220% (9522/10000) 100/100 

Epoch: 176
 [================================================================>]  Step: 87ms | Tot: 46s430ms | Loss: 0.002 | Acc: 99.982% (49991/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s352ms | Loss: 0.183 | Acc: 95.390% (9539/10000) 100/100 
Saving..

Epoch: 177
 [================================================================>]  Step: 87ms | Tot: 46s522ms | Loss: 0.002 | Acc: 99.984% (49992/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s322ms | Loss: 0.179 | Acc: 95.460% (9546/10000) 100/100 
Saving..

Epoch: 178
 [================================================================>]  Step: 85ms | Tot: 46s349ms | Loss: 0.002 | Acc: 99.984% (49992/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s521ms | Loss: 0.178 | Acc: 95.270% (9527/10000) 100/100 

Epoch: 179
 [================================================================>]  Step: 73ms | Tot: 46s114ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s229ms | Loss: 0.180 | Acc: 95.320% (9532/10000) 100/100 

Epoch: 180
 [================================================================>]  Step: 82ms | Tot: 46s82ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s300ms | Loss: 0.179 | Acc: 95.320% (9532/10000) 100/100 

Epoch: 181
 [================================================================>]  Step: 74ms | Tot: 46s435ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 26ms | Tot: 4s291ms | Loss: 0.177 | Acc: 95.350% (9535/10000) 100/100 

Epoch: 182
 [================================================================>]  Step: 79ms | Tot: 46s111ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s203ms | Loss: 0.177 | Acc: 95.330% (9533/10000) 100/100 

Epoch: 183
 [================================================================>]  Step: 77ms | Tot: 46s237ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s297ms | Loss: 0.174 | Acc: 95.410% (9541/10000) 100/100 

Epoch: 184
 [================================================================>]  Step: 84ms | Tot: 46s208ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s391ms | Loss: 0.174 | Acc: 95.390% (9539/10000) 100/100 

Epoch: 185
 [================================================================>]  Step: 76ms | Tot: 46s30ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 45ms | Tot: 4s239ms | Loss: 0.175 | Acc: 95.400% (9540/10000) 100/100 

Epoch: 186
 [================================================================>]  Step: 85ms | Tot: 46s508ms | Loss: 0.002 | Acc: 99.988% (49994/50000) 391/391 
 [================================================================>]  Step: 28ms | Tot: 4s366ms | Loss: 0.174 | Acc: 95.400% (9540/10000) 100/100 

Epoch: 187
 [================================================================>]  Step: 89ms | Tot: 46s481ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s312ms | Loss: 0.174 | Acc: 95.450% (9545/10000) 100/100 

Epoch: 188
 [================================================================>]  Step: 76ms | Tot: 46s341ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s220ms | Loss: 0.175 | Acc: 95.330% (9533/10000) 100/100 

Epoch: 189
 [================================================================>]  Step: 82ms | Tot: 46s352ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s277ms | Loss: 0.174 | Acc: 95.470% (9547/10000) 100/100 
Saving..

Epoch: 190
 [================================================================>]  Step: 71ms | Tot: 46s522ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s410ms | Loss: 0.173 | Acc: 95.470% (9547/10000) 100/100 

Epoch: 191
 [================================================================>]  Step: 79ms | Tot: 46s348ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s413ms | Loss: 0.173 | Acc: 95.420% (9542/10000) 100/100 

Epoch: 192
 [================================================================>]  Step: 82ms | Tot: 46s503ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s315ms | Loss: 0.173 | Acc: 95.410% (9541/10000) 100/100 

Epoch: 193
 [================================================================>]  Step: 79ms | Tot: 46s443ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s535ms | Loss: 0.172 | Acc: 95.470% (9547/10000) 100/100 

Epoch: 194
 [================================================================>]  Step: 80ms | Tot: 46s449ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 37ms | Tot: 4s348ms | Loss: 0.173 | Acc: 95.530% (9553/10000) 100/100 
Saving..

Epoch: 195
 [================================================================>]  Step: 87ms | Tot: 47s99ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s404ms | Loss: 0.173 | Acc: 95.470% (9547/10000) 100/100 

Epoch: 196
 [================================================================>]  Step: 85ms | Tot: 46s292ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 32ms | Tot: 4s375ms | Loss: 0.173 | Acc: 95.470% (9547/10000) 100/100 

Epoch: 197
 [================================================================>]  Step: 84ms | Tot: 46s961ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s405ms | Loss: 0.173 | Acc: 95.380% (9538/10000) 100/100 

Epoch: 198
 [================================================================>]  Step: 75ms | Tot: 46s757ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s405ms | Loss: 0.172 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 199
 [================================================================>]  Step: 89ms | Tot: 46s774ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s257ms | Loss: 0.172 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 200
 [================================================================>]  Step: 82ms | Tot: 46s692ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s327ms | Loss: 0.171 | Acc: 95.550% (9555/10000) 100/100 
Saving..

Epoch: 201
 [================================================================>]  Step: 78ms | Tot: 46s717ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s292ms | Loss: 0.173 | Acc: 95.400% (9540/10000) 100/100 

Epoch: 202
 [================================================================>]  Step: 87ms | Tot: 46s884ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s416ms | Loss: 0.173 | Acc: 95.440% (9544/10000) 100/100 

Epoch: 203
 [================================================================>]  Step: 76ms | Tot: 46s595ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s438ms | Loss: 0.173 | Acc: 95.430% (9543/10000) 100/100 

Epoch: 204
 [================================================================>]  Step: 77ms | Tot: 46s728ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s451ms | Loss: 0.171 | Acc: 95.450% (9545/10000) 100/100 

Epoch: 205
 [================================================================>]  Step: 81ms | Tot: 46s689ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s320ms | Loss: 0.172 | Acc: 95.440% (9544/10000) 100/100 

Epoch: 206
 [================================================================>]  Step: 75ms | Tot: 46s890ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s364ms | Loss: 0.172 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 207
 [================================================================>]  Step: 81ms | Tot: 46s646ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s336ms | Loss: 0.172 | Acc: 95.540% (9554/10000) 100/100 

Epoch: 208
 [================================================================>]  Step: 91ms | Tot: 46s744ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s300ms | Loss: 0.172 | Acc: 95.490% (9549/10000) 100/100 

Epoch: 209
 [================================================================>]  Step: 78ms | Tot: 46s683ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 53ms | Tot: 4s397ms | Loss: 0.172 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 210
 [================================================================>]  Step: 84ms | Tot: 46s486ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s325ms | Loss: 0.172 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 211
 [================================================================>]  Step: 88ms | Tot: 46s915ms | Loss: 0.002 | Acc: 99.996% (49998/50000) 391/391 
 [================================================================>]  Step: 83ms | Tot: 4s300ms | Loss: 0.173 | Acc: 95.480% (9548/10000) 100/100 

Epoch: 212
 [================================================================>]  Step: 83ms | Tot: 46s828ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s400ms | Loss: 0.173 | Acc: 95.410% (9541/10000) 100/100 

Epoch: 213
 [================================================================>]  Step: 83ms | Tot: 46s727ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s374ms | Loss: 0.173 | Acc: 95.490% (9549/10000) 100/100 

Epoch: 214
 [================================================================>]  Step: 86ms | Tot: 47s128ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 63ms | Tot: 4s433ms | Loss: 0.172 | Acc: 95.500% (9550/10000) 100/100 

Epoch: 215
 [================================================================>]  Step: 80ms | Tot: 46s929ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s393ms | Loss: 0.174 | Acc: 95.350% (9535/10000) 100/100 

Epoch: 216
 [================================================================>]  Step: 83ms | Tot: 46s930ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s349ms | Loss: 0.174 | Acc: 95.400% (9540/10000) 100/100 

Epoch: 217
 [================================================================>]  Step: 79ms | Tot: 46s559ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s384ms | Loss: 0.172 | Acc: 95.370% (9537/10000) 100/100 

Epoch: 218
 [================================================================>]  Step: 79ms | Tot: 46s656ms | Loss: 0.002 | Acc: 100.000% (50000/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s283ms | Loss: 0.174 | Acc: 95.360% (9536/10000) 100/100 

Epoch: 219
 [================================================================>]  Step: 79ms | Tot: 46s622ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 48ms | Tot: 4s509ms | Loss: 0.175 | Acc: 95.370% (9537/10000) 100/100 

Epoch: 220
 [================================================================>]  Step: 73ms | Tot: 46s900ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s449ms | Loss: 0.171 | Acc: 95.460% (9546/10000) 100/100 

Epoch: 221
 [================================================================>]  Step: 81ms | Tot: 46s735ms | Loss: 0.002 | Acc: 99.998% (49999/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s368ms | Loss: 0.172 | Acc: 95.410% (9541/10000) 100/100 

Epoch: 222
 [================================================================>]  Step: 94ms | Tot: 46s928ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s255ms | Loss: 0.172 | Acc: 95.310% (9531/10000) 100/100 

Epoch: 223
 [================================================================>]  Step: 76ms | Tot: 46s781ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 4s368ms | Loss: 0.172 | Acc: 95.520% (9552/10000) 100/100 

Epoch: 224
 [================================================================>]  Step: 81ms | Tot: 46s468ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 40ms | Tot: 4s398ms | Loss: 0.170 | Acc: 95.430% (9543/10000) 100/100 

Epoch: 225
 [================================================================>]  Step: 77ms | Tot: 46s860ms | Loss: 0.002 | Acc: 99.990% (49995/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s484ms | Loss: 0.178 | Acc: 95.290% (9529/10000) 100/100 

Epoch: 226
 [================================================================>]  Step: 71ms | Tot: 46s551ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 53ms | Tot: 4s543ms | Loss: 0.175 | Acc: 95.200% (9520/10000) 100/100 

Epoch: 227
 [================================================================>]  Step: 84ms | Tot: 46s816ms | Loss: 0.002 | Acc: 99.992% (49996/50000) 391/391 
 [================================================================>]  Step: 39ms | Tot: 4s302ms | Loss: 0.176 | Acc: 95.230% (9523/10000) 100/100 

Epoch: 228
 [================================================================>]  Step: 77ms | Tot: 46s667ms | Loss: 0.002 | Acc: 99.994% (49997/50000) 391/391 
 [================================================================>]  Step: 50ms | Tot: 4s369ms | Loss: 0.173 | Acc: 95.300% (9530/10000) 100/100 

Epoch: 229
 [================================================================>]  Step: 76ms | Tot: 46s977ms | Loss: 0.003 | Acc: 99.974% (49987/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s570ms | Loss: 0.192 | Acc: 95.000% (9500/10000) 100/100 

Epoch: 230
 [================================================================>]  Step: 93ms | Tot: 46s875ms | Loss: 0.004 | Acc: 99.928% (49964/50000) 391/391 
 [================================================================>]  Step: 44ms | Tot: 4s300ms | Loss: 0.196 | Acc: 94.860% (9486/10000) 100/100 

Epoch: 231
 [================================================================>]  Step: 80ms | Tot: 46s854ms | Loss: 0.008 | Acc: 99.814% (49907/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s291ms | Loss: 0.216 | Acc: 94.280% (9428/10000) 100/100 

Epoch: 232
 [================================================================>]  Step: 74ms | Tot: 46s558ms | Loss: 0.026 | Acc: 99.208% (49604/50000) 391/391 
 [================================================================>]  Step: 33ms | Tot: 4s418ms | Loss: 0.290 | Acc: 92.390% (9239/10000) 100/100 

Epoch: 233
 [================================================================>]  Step: 69ms | Tot: 46s683ms | Loss: 0.040 | Acc: 98.762% (49381/50000) 391/391 
 [================================================================>]  Step: 46ms | Tot: 4s503ms | Loss: 0.263 | Acc: 92.600% (9260/10000) 100/100 

Epoch: 234
 [================================================================>]  Step: 89ms | Tot: 46s490ms | Loss: 0.046 | Acc: 98.540% (49270/50000) 391/391 
 [================================================================>]  Step: 49ms | Tot: 4s419ms | Loss: 0.281 | Acc: 92.160% (9216/10000) 100/100 

Epoch: 235
 [================================================================>]  Step: 81ms | Tot: 46s824ms | Loss: 0.056 | Acc: 98.218% (49109/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s477ms | Loss: 0.280 | Acc: 91.930% (9193/10000) 100/100 

Epoch: 236
 [================================================================>]  Step: 90ms | Tot: 46s711ms | Loss: 0.065 | Acc: 97.916% (48958/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s392ms | Loss: 0.329 | Acc: 90.460% (9046/10000) 100/100 

Epoch: 237
 [================================================================>]  Step: 80ms | Tot: 46s751ms | Loss: 0.073 | Acc: 97.526% (48763/50000) 391/391 
 [================================================================>]  Step: 41ms | Tot: 4s342ms | Loss: 0.330 | Acc: 90.670% (9067/10000) 100/100 

Epoch: 238
 [================================================================>]  Step: 91ms | Tot: 46s689ms | Loss: 0.068 | Acc: 97.786% (48893/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s437ms | Loss: 0.292 | Acc: 91.600% (9160/10000) 100/100 

Epoch: 239
 [================================================================>]  Step: 80ms | Tot: 47s22ms | Loss: 0.071 | Acc: 97.674% (48837/50000) 391/391 
 [================================================================>]  Step: 43ms | Tot: 4s411ms | Loss: 0.297 | Acc: 91.560% (9156/10000) 100/100 

Epoch: 240
 [================================================================>]  Step: 82ms | Tot: 46s391ms | Loss: 0.076 | Acc: 97.504% (48752/50000) 391/391 
 [================================================================>]  Step: 42ms | Tot: 4s390ms | Loss: 0.278 | Acc: 91.670% (9167/10000) 100/100 

Epoch: 241
 [================================================================>]  Step: 70ms | Tot: 46s630ms | Loss: 0.077 | Acc: 97.408% (48704/50000) 391/391 
 [================================================================>]  Step: 31ms | Tot: 4s403ms | Loss: 0.325 | Acc: 90.510% (9051/10000) 100/100 

Epoch: 242
 [================================================================>]  Step: 82ms | Tot: 47s5ms | Loss: 0.075 | Acc: 97.528% (48764/50000) 391/391 
 [================================================================>]  Step: 54ms | Tot: 4s360ms | Loss: 0.313 | Acc: 91.000% (9100/10000) 100/100 

Epoch: 243
 [================================================================>]  Step: 72ms | Tot: 46s757ms | Loss: 0.086 | Acc: 97.100% (48550/50000) 391/391 
 [================================================================>]  Step: 30ms | Tot: 4s374ms | Loss: 0.328 | Acc: 90.580% (9058/10000) 100/100 

Epoch: 244
 [================================================================>]  Step: 85ms | Tot: 47s120ms | Loss: 0.078 | Acc: 97.444% (48722/50000) 391/391 
 [================================================================>]  Step: 35ms | Tot: 4s317ms | Loss: 0.282 | Acc: 91.460% (9146/10000) 100/100 

Epoch: 245
 [================================================================>]  Step: 91ms | Tot: 46s569ms | Loss: 0.078 | Acc: 97.366% (48683/50000) 391/391 
 [================================================================>]  Step: 34ms | Tot: 4s432ms | Loss: 0.311 | Acc: 90.990% (9099/10000) 100/100 

Epoch: 246
 [================================================================>]  Step: 85ms | Tot: 46s846ms | Loss: 0.082 | Acc: 97.246% (48623/50000) 391/391 
 [================================================================>]  Step: 36ms | Tot: 4s365ms | Loss: 0.260 | Acc: 92.130% (9213/10000) 100/100 

Epoch: 247
 [================================================================>]  Step: 87ms | Tot: 46s728ms | Loss: 0.080 | Acc: 97.274% (48637/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s389ms | Loss: 0.403 | Acc: 88.690% (8869/10000) 100/100 

Epoch: 248
 [================================================================>]  Step: 70ms | Tot: 46s411ms | Loss: 0.083 | Acc: 97.322% (48661/50000) 391/391 
 [================================================================>]  Step: 38ms | Tot: 4s331ms | Loss: 0.284 | Acc: 91.660% (9166/10000) 100/100 

Epoch: 249
 [================================================================>]  Step: 78ms | Tot: 46s731ms | Loss: 0.078 | Acc: 97.398% (48699/50000) 391/391 
 [================================================================>]  Step: 47ms | Tot: 4s308ms | Loss: 0.257 | Acc: 92.380% (9238/10000) 100/100 